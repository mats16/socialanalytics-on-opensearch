// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`Snapshot 1`] = `
Object {
  "Conditions": Object {
    "TweetProducerStreamReader1DisabledF9BFE6E9": Object {
      "Fn::Equals": Array [
        Object {
          "Ref": "TweetProducerStreamReader1BearerTokenB1FAF3C8",
        },
        "N/A",
      ],
    },
    "TweetProducerStreamReader2Disabled63DEA594": Object {
      "Fn::Equals": Array [
        Object {
          "Ref": "TweetProducerStreamReader2BearerToken679CDF8C",
        },
        "N/A",
      ],
    },
    "TweetProducerStreamReader3Disabled4F1E6EA5": Object {
      "Fn::Equals": Array [
        Object {
          "Ref": "TweetProducerStreamReader3BearerToken372B9251",
        },
        "N/A",
      ],
    },
  },
  "Mappings": Object {
    "ServiceprincipalMap": Object {
      "af-south-1": Object {
        "states": "states.af-south-1.amazonaws.com",
      },
      "ap-east-1": Object {
        "states": "states.ap-east-1.amazonaws.com",
      },
      "ap-northeast-1": Object {
        "states": "states.ap-northeast-1.amazonaws.com",
      },
      "ap-northeast-2": Object {
        "states": "states.ap-northeast-2.amazonaws.com",
      },
      "ap-northeast-3": Object {
        "states": "states.ap-northeast-3.amazonaws.com",
      },
      "ap-south-1": Object {
        "states": "states.ap-south-1.amazonaws.com",
      },
      "ap-southeast-1": Object {
        "states": "states.ap-southeast-1.amazonaws.com",
      },
      "ap-southeast-2": Object {
        "states": "states.ap-southeast-2.amazonaws.com",
      },
      "ap-southeast-3": Object {
        "states": "states.ap-southeast-3.amazonaws.com",
      },
      "ca-central-1": Object {
        "states": "states.ca-central-1.amazonaws.com",
      },
      "cn-north-1": Object {
        "states": "states.cn-north-1.amazonaws.com",
      },
      "cn-northwest-1": Object {
        "states": "states.cn-northwest-1.amazonaws.com",
      },
      "eu-central-1": Object {
        "states": "states.eu-central-1.amazonaws.com",
      },
      "eu-north-1": Object {
        "states": "states.eu-north-1.amazonaws.com",
      },
      "eu-south-1": Object {
        "states": "states.eu-south-1.amazonaws.com",
      },
      "eu-south-2": Object {
        "states": "states.eu-south-2.amazonaws.com",
      },
      "eu-west-1": Object {
        "states": "states.eu-west-1.amazonaws.com",
      },
      "eu-west-2": Object {
        "states": "states.eu-west-2.amazonaws.com",
      },
      "eu-west-3": Object {
        "states": "states.eu-west-3.amazonaws.com",
      },
      "me-central-1": Object {
        "states": "states.me-central-1.amazonaws.com",
      },
      "me-south-1": Object {
        "states": "states.me-south-1.amazonaws.com",
      },
      "sa-east-1": Object {
        "states": "states.sa-east-1.amazonaws.com",
      },
      "us-east-1": Object {
        "states": "states.us-east-1.amazonaws.com",
      },
      "us-east-2": Object {
        "states": "states.us-east-2.amazonaws.com",
      },
      "us-gov-east-1": Object {
        "states": "states.us-gov-east-1.amazonaws.com",
      },
      "us-gov-west-1": Object {
        "states": "states.us-gov-west-1.amazonaws.com",
      },
      "us-iso-east-1": Object {
        "states": "states.amazonaws.com",
      },
      "us-iso-west-1": Object {
        "states": "states.amazonaws.com",
      },
      "us-isob-east-1": Object {
        "states": "states.amazonaws.com",
      },
      "us-west-1": Object {
        "states": "states.us-west-1.amazonaws.com",
      },
      "us-west-2": Object {
        "states": "states.us-west-2.amazonaws.com",
      },
    },
  },
  "Parameters": Object {
    "BootstrapVersion": Object {
      "Default": "/cdk-bootstrap/hnb659fds/version",
      "Description": "Version of the CDK Bootstrap resources in this environment, automatically retrieved from SSM Parameter Store. [cdk:skip]",
      "Type": "AWS::SSM::Parameter::Value<String>",
    },
    "TweetProducerStreamReader1BearerTokenB1FAF3C8": Object {
      "Default": "N/A",
      "Description": "Bearer Token for Twitter API v2",
      "NoEcho": true,
      "Type": "String",
    },
    "TweetProducerStreamReader2BearerToken679CDF8C": Object {
      "Default": "N/A",
      "Description": "Bearer Token for Twitter API v2",
      "NoEcho": true,
      "Type": "String",
    },
    "TweetProducerStreamReader3BearerToken372B9251": Object {
      "Default": "N/A",
      "Description": "Bearer Token for Twitter API v2",
      "NoEcho": true,
      "Type": "String",
    },
  },
  "Resources": Object {
    "AWS679f53fac002430cb0da5b7982bd22872D164C4C": Object {
      "DependsOn": Array [
        "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2",
      ],
      "Properties": Object {
        "Code": Object {
          "S3Bucket": Object {
            "Fn::Sub": "cdk-hnb659fds-assets-\${AWS::AccountId}-\${AWS::Region}",
          },
          "S3Key": "e845402ce43b66fc6f20df4a239f20f8662eb6c7f920b94cf6542dd0e64ce0f7.zip",
        },
        "Handler": "index.handler",
        "Role": Object {
          "Fn::GetAtt": Array [
            "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2",
            "Arn",
          ],
        },
        "Runtime": "nodejs14.x",
        "Timeout": 120,
      },
      "Type": "AWS::Lambda::Function",
    },
    "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "AnalyzeFunction5A98DC09": Object {
      "DependsOn": Array [
        "AnalyzeFunctionServiceRoleDefaultPolicyC2F006BE",
        "AnalyzeFunctionServiceRole2A2C257B",
      ],
      "Properties": Object {
        "Architectures": Array [
          "arm64",
        ],
        "Code": Object {
          "S3Bucket": Object {
            "Fn::Sub": "cdk-hnb659fds-assets-\${AWS::AccountId}-\${AWS::Region}",
          },
          "S3Key": "72102a240f66fd7b9dd9a0a927fd18c376bfe260361b18235e2aa6c4932e6669.zip",
        },
        "Description": "[SocialAnalytics] Amazon Comprehend",
        "Environment": Object {
          "Variables": Object {
            "AWS_NODEJS_CONNECTION_REUSE_ENABLED": "1",
            "COMPREHEND_JOB_ARN": Object {
              "Ref": "ComprehendJobStateMachine877998A5",
            },
            "POWERTOOLS_METRICS_NAMESPACE": Object {
              "Ref": "AWS::StackName",
            },
            "POWERTOOLS_SERVICE_NAME": "AnalyzeFunction",
            "TWEET_TABLE_NAME": Object {
              "Ref": "TweetTable97F090DB",
            },
          },
        },
        "Handler": "index.handler",
        "Layers": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:aws:lambda:",
                Object {
                  "Ref": "AWS::Region",
                },
                ":580247275435:layer:LambdaInsightsExtension-Arm64:2",
              ],
            ],
          },
        ],
        "MemorySize": 256,
        "Role": Object {
          "Fn::GetAtt": Array [
            "AnalyzeFunctionServiceRole2A2C257B",
            "Arn",
          ],
        },
        "Runtime": "nodejs18.x",
        "Timeout": 60,
        "TracingConfig": Object {
          "Mode": "Active",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "AnalyzeFunctionDynamoDBEventSourcetestTweetTable04D577993C12838A": Object {
      "Properties": Object {
        "BatchSize": 100,
        "EventSourceArn": Object {
          "Fn::GetAtt": Array [
            "TweetTable97F090DB",
            "StreamArn",
          ],
        },
        "FunctionName": Object {
          "Ref": "AnalyzeFunction5A98DC09",
        },
        "MaximumBatchingWindowInSeconds": 5,
        "MaximumRecordAgeInSeconds": 86400,
        "StartingPosition": "LATEST",
      },
      "Type": "AWS::Lambda::EventSourceMapping",
    },
    "AnalyzeFunctionServiceRole2A2C257B": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/CloudWatchLambdaInsightsExecutionRolePolicy",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "AnalyzeFunctionServiceRoleDefaultPolicyC2F006BE": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": Array [
                "xray:PutTraceSegments",
                "xray:PutTelemetryRecords",
              ],
              "Effect": "Allow",
              "Resource": "*",
            },
            Object {
              "Action": "dynamodb:ListStreams",
              "Effect": "Allow",
              "Resource": "*",
            },
            Object {
              "Action": Array [
                "dynamodb:DescribeStream",
                "dynamodb:GetRecords",
                "dynamodb:GetShardIterator",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "TweetTable97F090DB",
                  "StreamArn",
                ],
              },
            },
            Object {
              "Action": Array [
                "dynamodb:BatchWriteItem",
                "dynamodb:PutItem",
                "dynamodb:UpdateItem",
                "dynamodb:DeleteItem",
                "dynamodb:DescribeTable",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "TweetTable97F090DB",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "TweetTable97F090DB",
                          "Arn",
                        ],
                      },
                      "/index/*",
                    ],
                  ],
                },
              ],
            },
            Object {
              "Action": "states:StartSyncExecution",
              "Effect": "Allow",
              "Resource": Object {
                "Ref": "ComprehendJobStateMachine877998A5",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "AnalyzeFunctionServiceRoleDefaultPolicyC2F006BE",
        "Roles": Array [
          Object {
            "Ref": "AnalyzeFunctionServiceRole2A2C257B",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "AppConfigApplication559632A2": Object {
      "Properties": Object {
        "Name": "test",
      },
      "Type": "AWS::AppConfig::Application",
    },
    "AppConfigApplicationFastDeploy0AFC784A": Object {
      "Properties": Object {
        "DeploymentDurationInMinutes": 0,
        "FinalBakeTimeInMinutes": 0,
        "GrowthFactor": 100,
        "Name": "test.FastDeploy",
        "ReplicateTo": "NONE",
      },
      "Type": "AWS::AppConfig::DeploymentStrategy",
    },
    "AppConfigApplicationProduction11A5678C": Object {
      "Properties": Object {
        "ApplicationId": Object {
          "Ref": "AppConfigApplication559632A2",
        },
        "Name": "Production",
      },
      "Type": "AWS::AppConfig::Environment",
    },
    "AppConfigApplicationProductionTwitterFilterContextDomainsDeploy14EE39A32": Object {
      "Properties": Object {
        "ApplicationId": Object {
          "Ref": "AppConfigApplication559632A2",
        },
        "ConfigurationProfileId": Object {
          "Ref": "AppConfigApplicationTwitterFilterContextDomainsC280D03C",
        },
        "ConfigurationVersion": "1",
        "DeploymentStrategyId": Object {
          "Ref": "AppConfigApplicationFastDeploy0AFC784A",
        },
        "EnvironmentId": Object {
          "Ref": "AppConfigApplicationProduction11A5678C",
        },
      },
      "Type": "AWS::AppConfig::Deployment",
    },
    "AppConfigApplicationProductionTwitterFilterSourceLabelsDeploy1DE08108E": Object {
      "Properties": Object {
        "ApplicationId": Object {
          "Ref": "AppConfigApplication559632A2",
        },
        "ConfigurationProfileId": Object {
          "Ref": "AppConfigApplicationTwitterFilterSourceLabels567004A8",
        },
        "ConfigurationVersion": "1",
        "DeploymentStrategyId": Object {
          "Ref": "AppConfigApplicationFastDeploy0AFC784A",
        },
        "EnvironmentId": Object {
          "Ref": "AppConfigApplicationProduction11A5678C",
        },
      },
      "Type": "AWS::AppConfig::Deployment",
    },
    "AppConfigApplicationRetrievalRole0D6E6903": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "appconfig.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "Description": "AppConfigServiceRole",
      },
      "Type": "AWS::IAM::Role",
    },
    "AppConfigApplicationRetrievalRoleDefaultPolicy76E93B2F": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": Array [
                "ssm:DescribeParameters",
                "ssm:GetParameters",
                "ssm:GetParameter",
                "ssm:GetParameterHistory",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::Join": Array [
                  "",
                  Array [
                    "arn:",
                    Object {
                      "Ref": "AWS::Partition",
                    },
                    ":ssm:",
                    Object {
                      "Ref": "AWS::Region",
                    },
                    ":",
                    Object {
                      "Ref": "AWS::AccountId",
                    },
                    ":parameter",
                    Object {
                      "Ref": "twitterFilterContextDomainsAC1EB275",
                    },
                  ],
                ],
              },
            },
            Object {
              "Action": Array [
                "ssm:DescribeParameters",
                "ssm:GetParameters",
                "ssm:GetParameter",
                "ssm:GetParameterHistory",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::Join": Array [
                  "",
                  Array [
                    "arn:",
                    Object {
                      "Ref": "AWS::Partition",
                    },
                    ":ssm:",
                    Object {
                      "Ref": "AWS::Region",
                    },
                    ":",
                    Object {
                      "Ref": "AWS::AccountId",
                    },
                    ":parameter",
                    Object {
                      "Ref": "twitterFilterSourceLabelsEC9A582C",
                    },
                  ],
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "AppConfigApplicationRetrievalRoleDefaultPolicy76E93B2F",
        "Roles": Array [
          Object {
            "Ref": "AppConfigApplicationRetrievalRole0D6E6903",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "AppConfigApplicationTwitterFilterContextDomainsC280D03C": Object {
      "DependsOn": Array [
        "AppConfigApplicationRetrievalRoleDefaultPolicy76E93B2F",
      ],
      "Properties": Object {
        "ApplicationId": Object {
          "Ref": "AppConfigApplication559632A2",
        },
        "LocationUri": Object {
          "Fn::Join": Array [
            "",
            Array [
              "ssm-parameter://",
              Object {
                "Ref": "twitterFilterContextDomainsAC1EB275",
              },
            ],
          ],
        },
        "Name": "TwitterFilterContextDomains",
        "RetrievalRoleArn": Object {
          "Fn::GetAtt": Array [
            "AppConfigApplicationRetrievalRole0D6E6903",
            "Arn",
          ],
        },
      },
      "Type": "AWS::AppConfig::ConfigurationProfile",
    },
    "AppConfigApplicationTwitterFilterSourceLabels567004A8": Object {
      "DependsOn": Array [
        "AppConfigApplicationRetrievalRoleDefaultPolicy76E93B2F",
      ],
      "Properties": Object {
        "ApplicationId": Object {
          "Ref": "AppConfigApplication559632A2",
        },
        "LocationUri": Object {
          "Fn::Join": Array [
            "",
            Array [
              "ssm-parameter://",
              Object {
                "Ref": "twitterFilterSourceLabelsEC9A582C",
              },
            ],
          ],
        },
        "Name": "TwitterFilterSourceLabels",
        "RetrievalRoleArn": Object {
          "Fn::GetAtt": Array [
            "AppConfigApplicationRetrievalRole0D6E6903",
            "Arn",
          ],
        },
      },
      "Type": "AWS::AppConfig::ConfigurationProfile",
    },
    "ArchiveEventFunctionA15B0833": Object {
      "DependsOn": Array [
        "ArchiveEventFunctionServiceRoleDefaultPolicy90739CF6",
        "ArchiveEventFunctionServiceRoleC71B0630",
      ],
      "Properties": Object {
        "Architectures": Array [
          "arm64",
        ],
        "Code": Object {
          "S3Bucket": Object {
            "Fn::Sub": "cdk-hnb659fds-assets-\${AWS::AccountId}-\${AWS::Region}",
          },
          "S3Key": "f561fa7dd410d4130215ca21cf69f3973726b44e64a5aa68b0a8af07fe1319cc.zip",
        },
        "Description": "[SocialAnalytics] Archive event for Firehose-S3",
        "Environment": Object {
          "Variables": Object {
            "AWS_NODEJS_CONNECTION_REUSE_ENABLED": "1",
            "DELIVERY_STREAM_NAME": Object {
              "Ref": "ArchiveStreamC19F14A8",
            },
            "POWERTOOLS_METRICS_NAMESPACE": Object {
              "Ref": "AWS::StackName",
            },
            "POWERTOOLS_SERVICE_NAME": "ArchiveEventFunction",
          },
        },
        "Handler": "index.handler",
        "Layers": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:aws:lambda:",
                Object {
                  "Ref": "AWS::Region",
                },
                ":580247275435:layer:LambdaInsightsExtension-Arm64:2",
              ],
            ],
          },
        ],
        "Role": Object {
          "Fn::GetAtt": Array [
            "ArchiveEventFunctionServiceRoleC71B0630",
            "Arn",
          ],
        },
        "Runtime": "nodejs18.x",
        "Timeout": 5,
        "TracingConfig": Object {
          "Mode": "Active",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "ArchiveEventFunctionServiceRoleC71B0630": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/CloudWatchLambdaInsightsExecutionRolePolicy",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "ArchiveEventFunctionServiceRoleDefaultPolicy90739CF6": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": Array [
                "xray:PutTraceSegments",
                "xray:PutTelemetryRecords",
              ],
              "Effect": "Allow",
              "Resource": "*",
            },
            Object {
              "Action": "firehose:PutRecord",
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "ArchiveStreamC19F14A8",
                  "Arn",
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "ArchiveEventFunctionServiceRoleDefaultPolicy90739CF6",
        "Roles": Array [
          Object {
            "Ref": "ArchiveEventFunctionServiceRoleC71B0630",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "ArchiveEventRule328559D8": Object {
      "Properties": Object {
        "EventBusName": Object {
          "Ref": "TwitterEventBusC40513FF",
        },
        "EventPattern": Object {
          "detail": Object {
            "data": Object {
              "source": Array [
                Object {
                  "anything-but": Object {
                    "Fn::Split": Array [
                      ",",
                      Object {
                        "Fn::GetAtt": Array [
                          "twitterFilterSourceLabelsEC9A582C",
                          "Value",
                        ],
                      },
                    ],
                  },
                },
              ],
            },
          },
          "source": Array [
            "twitter.api.v2",
          ],
        },
        "State": "ENABLED",
        "Targets": Array [
          Object {
            "Arn": Object {
              "Fn::GetAtt": Array [
                "ArchiveEventFunctionA15B0833",
                "Arn",
              ],
            },
            "Id": "Target0",
          },
        ],
      },
      "Type": "AWS::Events::Rule",
    },
    "ArchiveEventRuleAllowEventRuletestArchiveEventFunctionFB0755F8D73EADE1": Object {
      "Properties": Object {
        "Action": "lambda:InvokeFunction",
        "FunctionName": Object {
          "Fn::GetAtt": Array [
            "ArchiveEventFunctionA15B0833",
            "Arn",
          ],
        },
        "Principal": "events.amazonaws.com",
        "SourceArn": Object {
          "Fn::GetAtt": Array [
            "ArchiveEventRule328559D8",
            "Arn",
          ],
        },
      },
      "Type": "AWS::Lambda::Permission",
    },
    "ArchiveStreamC19F14A8": Object {
      "Properties": Object {
        "DeliveryStreamType": "DirectPut",
        "ExtendedS3DestinationConfiguration": Object {
          "BucketARN": Object {
            "Fn::GetAtt": Array [
              "Bucket83908E77",
              "Arn",
            ],
          },
          "BufferingHints": Object {
            "IntervalInSeconds": 900,
            "SizeInMBs": 128,
          },
          "CloudWatchLoggingOptions": Object {
            "Enabled": true,
            "LogGroupName": Object {
              "Ref": "ArchiveStreamLogGroupA05A9A51",
            },
            "LogStreamName": "ErrorLogs",
          },
          "CompressionFormat": "GZIP",
          "DynamicPartitioningConfiguration": Object {
            "Enabled": true,
          },
          "ErrorOutputPrefix": "raw/tweets/v2-error/!{firehose:error-output-type}/",
          "Prefix": "raw/tweets/v2/year=!{partitionKeyFromQuery:year}/month=!{partitionKeyFromQuery:month}/day=!{partitionKeyFromQuery:day}/",
          "ProcessingConfiguration": Object {
            "Enabled": true,
            "Processors": Array [
              Object {
                "Parameters": Array [
                  Object {
                    "ParameterName": "MetadataExtractionQuery",
                    "ParameterValue": "{                    year : .data.created_at | split(\\".\\")[0] | strptime(\\"%Y-%m-%dT%H:%M:%S\\") | strftime(\\"%Y\\"),                    month : .data.created_at | split(\\".\\")[0] | strptime(\\"%Y-%m-%dT%H:%M:%S\\") | strftime(\\"%m\\"),                    day : .data.created_at | split(\\".\\")[0] | strptime(\\"%Y-%m-%dT%H:%M:%S\\") | strftime(\\"%d\\")                  }",
                  },
                  Object {
                    "ParameterName": "JsonParsingEngine",
                    "ParameterValue": "JQ-1.6",
                  },
                ],
                "Type": "MetadataExtraction",
              },
              Object {
                "Parameters": Array [
                  Object {
                    "ParameterName": "Delimiter",
                    "ParameterValue": "\\\\n",
                  },
                ],
                "Type": "AppendDelimiterToRecord",
              },
            ],
          },
          "RoleARN": Object {
            "Fn::GetAtt": Array [
              "ArchiveStreamRole555DA523",
              "Arn",
            ],
          },
        },
      },
      "Type": "AWS::KinesisFirehose::DeliveryStream",
    },
    "ArchiveStreamLogGroupA05A9A51": Object {
      "DeletionPolicy": "Retain",
      "Properties": Object {
        "RetentionInDays": 14,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Retain",
    },
    "ArchiveStreamRole555DA523": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "firehose.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
      },
      "Type": "AWS::IAM::Role",
    },
    "ArchiveStreamRoleDefaultPolicyD4D429E6": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": Array [
                "s3:PutObject",
                "s3:PutObjectLegalHold",
                "s3:PutObjectRetention",
                "s3:PutObjectTagging",
                "s3:PutObjectVersionTagging",
                "s3:Abort*",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::Join": Array [
                  "",
                  Array [
                    Object {
                      "Fn::GetAtt": Array [
                        "Bucket83908E77",
                        "Arn",
                      ],
                    },
                    "/[object Object]",
                  ],
                ],
              },
            },
            Object {
              "Action": Array [
                "logs:CreateLogStream",
                "logs:PutLogEvents",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "ArchiveStreamLogGroupA05A9A51",
                  "Arn",
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "ArchiveStreamRoleDefaultPolicyD4D429E6",
        "Roles": Array [
          Object {
            "Ref": "ArchiveStreamRole555DA523",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "Bucket83908E77": Object {
      "DeletionPolicy": "Retain",
      "Properties": Object {
        "BucketEncryption": Object {
          "ServerSideEncryptionConfiguration": Array [
            Object {
              "ServerSideEncryptionByDefault": Object {
                "SSEAlgorithm": "AES256",
              },
            },
          ],
        },
        "LifecycleConfiguration": Object {
          "Rules": Array [
            Object {
              "Prefix": "raw",
              "Status": "Enabled",
              "Transitions": Array [
                Object {
                  "StorageClass": "INTELLIGENT_TIERING",
                  "TransitionInDays": 0,
                },
              ],
            },
          ],
        },
        "Tags": Array [
          Object {
            "Key": "aws-cdk:cr-owned:opensearch/packages/:8bae5dbc",
            "Value": "true",
          },
        ],
      },
      "Type": "AWS::S3::Bucket",
      "UpdateReplacePolicy": "Retain",
    },
    "BucketAllowBucketNotificationsTotestOpenSearchPackagesRegisterFunction51C3D6FB3E6375B2": Object {
      "Properties": Object {
        "Action": "lambda:InvokeFunction",
        "FunctionName": Object {
          "Fn::GetAtt": Array [
            "OpenSearchPackagesRegisterFunction7CDCEE20",
            "Arn",
          ],
        },
        "Principal": "s3.amazonaws.com",
        "SourceAccount": Object {
          "Ref": "AWS::AccountId",
        },
        "SourceArn": Object {
          "Fn::GetAtt": Array [
            "Bucket83908E77",
            "Arn",
          ],
        },
      },
      "Type": "AWS::Lambda::Permission",
    },
    "BucketNotifications8F2E257D": Object {
      "DependsOn": Array [
        "BucketAllowBucketNotificationsTotestOpenSearchPackagesRegisterFunction51C3D6FB3E6375B2",
      ],
      "Properties": Object {
        "BucketName": Object {
          "Ref": "Bucket83908E77",
        },
        "Managed": true,
        "NotificationConfiguration": Object {
          "LambdaFunctionConfigurations": Array [
            Object {
              "Events": Array [
                "s3:ObjectCreated:*",
              ],
              "Filter": Object {
                "Key": Object {
                  "FilterRules": Array [
                    Object {
                      "Name": "suffix",
                      "Value": ".txt",
                    },
                    Object {
                      "Name": "prefix",
                      "Value": "opensearch/packages/",
                    },
                  ],
                },
              },
              "LambdaFunctionArn": Object {
                "Fn::GetAtt": Array [
                  "OpenSearchPackagesRegisterFunction7CDCEE20",
                  "Arn",
                ],
              },
            },
          ],
        },
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "BucketNotificationsHandler050a0587b7544547bf325f094a3db8347ECC3691",
            "Arn",
          ],
        },
      },
      "Type": "Custom::S3BucketNotifications",
    },
    "BucketNotificationsHandler050a0587b7544547bf325f094a3db8347ECC3691": Object {
      "DependsOn": Array [
        "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleDefaultPolicy2CF63D36",
        "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC",
      ],
      "Properties": Object {
        "Code": Object {
          "ZipFile": "import boto3  # type: ignore
import json
import logging
import urllib.request

s3 = boto3.client(\\"s3\\")

EVENTBRIDGE_CONFIGURATION = 'EventBridgeConfiguration'

CONFIGURATION_TYPES = [\\"TopicConfigurations\\", \\"QueueConfigurations\\", \\"LambdaFunctionConfigurations\\"]

def handler(event: dict, context):
  response_status = \\"SUCCESS\\"
  error_message = \\"\\"
  try:
    props = event[\\"ResourceProperties\\"]
    bucket = props[\\"BucketName\\"]
    notification_configuration = props[\\"NotificationConfiguration\\"]
    request_type = event[\\"RequestType\\"]
    managed = props.get('Managed', 'true').lower() == 'true'
    stack_id = event['StackId']

    if managed:
      config = handle_managed(request_type, notification_configuration)
    else:
      config = handle_unmanaged(bucket, stack_id, request_type, notification_configuration)

    put_bucket_notification_configuration(bucket, config)
  except Exception as e:
    logging.exception(\\"Failed to put bucket notification configuration\\")
    response_status = \\"FAILED\\"
    error_message = f\\"Error: {str(e)}. \\"
  finally:
    submit_response(event, context, response_status, error_message)

def handle_managed(request_type, notification_configuration):
  if request_type == 'Delete':
    return {}
  return notification_configuration

def handle_unmanaged(bucket, stack_id, request_type, notification_configuration):
  external_notifications = find_external_notifications(bucket, stack_id)

  if request_type == 'Delete':
    return external_notifications

  def with_id(notification):
    notification['Id'] = f\\"{stack_id}-{hash(json.dumps(notification, sort_keys=True))}\\"
    return notification

  notifications = {}
  for t in CONFIGURATION_TYPES:
    external = external_notifications.get(t, [])
    incoming = [with_id(n) for n in notification_configuration.get(t, [])]
    notifications[t] = external + incoming

  if EVENTBRIDGE_CONFIGURATION in notification_configuration:
    notifications[EVENTBRIDGE_CONFIGURATION] = notification_configuration[EVENTBRIDGE_CONFIGURATION]
  elif EVENTBRIDGE_CONFIGURATION in external_notifications:
    notifications[EVENTBRIDGE_CONFIGURATION] = external_notifications[EVENTBRIDGE_CONFIGURATION]

  return notifications

def find_external_notifications(bucket, stack_id):
  existing_notifications = get_bucket_notification_configuration(bucket)
  external_notifications = {}
  for t in CONFIGURATION_TYPES:
    external_notifications[t] = [n for n in existing_notifications.get(t, []) if not n['Id'].startswith(f\\"{stack_id}-\\")]

  if EVENTBRIDGE_CONFIGURATION in existing_notifications:
    external_notifications[EVENTBRIDGE_CONFIGURATION] = existing_notifications[EVENTBRIDGE_CONFIGURATION]

  return external_notifications

def get_bucket_notification_configuration(bucket):
  return s3.get_bucket_notification_configuration(Bucket=bucket)

def put_bucket_notification_configuration(bucket, notification_configuration):
  s3.put_bucket_notification_configuration(Bucket=bucket, NotificationConfiguration=notification_configuration)

def submit_response(event: dict, context, response_status: str, error_message: str):
  response_body = json.dumps(
    {
      \\"Status\\": response_status,
      \\"Reason\\": f\\"{error_message}See the details in CloudWatch Log Stream: {context.log_stream_name}\\",
      \\"PhysicalResourceId\\": event.get(\\"PhysicalResourceId\\") or event[\\"LogicalResourceId\\"],
      \\"StackId\\": event[\\"StackId\\"],
      \\"RequestId\\": event[\\"RequestId\\"],
      \\"LogicalResourceId\\": event[\\"LogicalResourceId\\"],
      \\"NoEcho\\": False,
    }
  ).encode(\\"utf-8\\")
  headers = {\\"content-type\\": \\"\\", \\"content-length\\": str(len(response_body))}
  try:
    req = urllib.request.Request(url=event[\\"ResponseURL\\"], headers=headers, data=response_body, method=\\"PUT\\")
    with urllib.request.urlopen(req) as response:
      print(response.read().decode(\\"utf-8\\"))
    print(\\"Status code: \\" + response.reason)
  except Exception as e:
      print(\\"send(..) failed executing request.urlopen(..): \\" + str(e))
",
        },
        "Description": "AWS CloudFormation handler for \\"Custom::S3BucketNotifications\\" resources (@aws-cdk/aws-s3)",
        "Handler": "index.handler",
        "Role": Object {
          "Fn::GetAtt": Array [
            "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC",
            "Arn",
          ],
        },
        "Runtime": "python3.7",
        "Timeout": 300,
      },
      "Type": "AWS::Lambda::Function",
    },
    "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleDefaultPolicy2CF63D36": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "s3:PutBucketNotification",
              "Effect": "Allow",
              "Resource": "*",
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleDefaultPolicy2CF63D36",
        "Roles": Array [
          Object {
            "Ref": "BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "ComprehendJobB64DecodeFunctionCFAE8AF0": Object {
      "DependsOn": Array [
        "ComprehendJobB64DecodeFunctionServiceRoleAE097ABD",
      ],
      "Properties": Object {
        "Architectures": Array [
          "arm64",
        ],
        "Code": Object {
          "S3Bucket": Object {
            "Fn::Sub": "cdk-hnb659fds-assets-\${AWS::AccountId}-\${AWS::Region}",
          },
          "S3Key": "5d98d7dc54802c99cf9cb89806692474c90d937a0c522d5455d062db7f90846f.zip",
        },
        "Environment": Object {
          "Variables": Object {
            "AWS_NODEJS_CONNECTION_REUSE_ENABLED": "1",
            "POWERTOOLS_METRICS_NAMESPACE": Object {
              "Ref": "AWS::StackName",
            },
            "POWERTOOLS_SERVICE_NAME": "ComprehendWithCache",
          },
        },
        "Handler": "index.handler",
        "Role": Object {
          "Fn::GetAtt": Array [
            "ComprehendJobB64DecodeFunctionServiceRoleAE097ABD",
            "Arn",
          ],
        },
        "Runtime": "nodejs18.x",
        "Timeout": 5,
      },
      "Type": "AWS::Lambda::Function",
    },
    "ComprehendJobB64DecodeFunctionServiceRoleAE097ABD": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "ComprehendJobB64EncodeFunctionE10510B6": Object {
      "DependsOn": Array [
        "ComprehendJobB64EncodeFunctionServiceRole6283ED2A",
      ],
      "Properties": Object {
        "Architectures": Array [
          "arm64",
        ],
        "Code": Object {
          "S3Bucket": Object {
            "Fn::Sub": "cdk-hnb659fds-assets-\${AWS::AccountId}-\${AWS::Region}",
          },
          "S3Key": "7b17add3f74ae69712cd571bd5bdc602c638dcccc7b28bf25ed1c2e9f76a0929.zip",
        },
        "Environment": Object {
          "Variables": Object {
            "AWS_NODEJS_CONNECTION_REUSE_ENABLED": "1",
            "CACHE_EXPIRE_DAYS": "14",
            "POWERTOOLS_METRICS_NAMESPACE": Object {
              "Ref": "AWS::StackName",
            },
            "POWERTOOLS_SERVICE_NAME": "ComprehendWithCache",
          },
        },
        "Handler": "index.handler",
        "Role": Object {
          "Fn::GetAtt": Array [
            "ComprehendJobB64EncodeFunctionServiceRole6283ED2A",
            "Arn",
          ],
        },
        "Runtime": "nodejs18.x",
        "Timeout": 5,
      },
      "Type": "AWS::Lambda::Function",
    },
    "ComprehendJobB64EncodeFunctionServiceRole6283ED2A": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "ComprehendJobCacheTable2D64C528": Object {
      "DeletionPolicy": "Retain",
      "Properties": Object {
        "AttributeDefinitions": Array [
          Object {
            "AttributeName": "id",
            "AttributeType": "S",
          },
        ],
        "BillingMode": "PAY_PER_REQUEST",
        "KeySchema": Array [
          Object {
            "AttributeName": "id",
            "KeyType": "HASH",
          },
        ],
        "TimeToLiveSpecification": Object {
          "AttributeName": "expire",
          "Enabled": true,
        },
      },
      "Type": "AWS::DynamoDB::Table",
      "UpdateReplacePolicy": "Retain",
    },
    "ComprehendJobLogs46527FF7": Object {
      "DeletionPolicy": "Retain",
      "Properties": Object {
        "RetentionInDays": 14,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Retain",
    },
    "ComprehendJobNormalizeFunction49B1DB7D": Object {
      "DependsOn": Array [
        "ComprehendJobNormalizeFunctionServiceRoleDCC912C2",
      ],
      "Properties": Object {
        "Architectures": Array [
          "arm64",
        ],
        "Code": Object {
          "S3Bucket": Object {
            "Fn::Sub": "cdk-hnb659fds-assets-\${AWS::AccountId}-\${AWS::Region}",
          },
          "S3Key": "c851fd612f87edd0538fefa0347225a1cf112fb119ded0aa53cacbf4bd20582e.zip",
        },
        "Environment": Object {
          "Variables": Object {
            "AWS_NODEJS_CONNECTION_REUSE_ENABLED": "1",
            "POWERTOOLS_METRICS_NAMESPACE": Object {
              "Ref": "AWS::StackName",
            },
            "POWERTOOLS_SERVICE_NAME": "ComprehendWithCache",
          },
        },
        "Handler": "index.handler",
        "Role": Object {
          "Fn::GetAtt": Array [
            "ComprehendJobNormalizeFunctionServiceRoleDCC912C2",
            "Arn",
          ],
        },
        "Runtime": "nodejs18.x",
        "Timeout": 5,
      },
      "Type": "AWS::Lambda::Function",
    },
    "ComprehendJobNormalizeFunctionServiceRoleDCC912C2": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "ComprehendJobStateMachine877998A5": Object {
      "DependsOn": Array [
        "ComprehendJobStateMachineRoleDefaultPolicyF1625302",
        "ComprehendJobStateMachineRole8E097225",
      ],
      "Properties": Object {
        "DefinitionString": Object {
          "Fn::Join": Array [
            "",
            Array [
              "{\\"StartAt\\":\\"Invoke\\",\\"States\\":{\\"Invoke\\":{\\"Type\\":\\"Pass\\",\\"Parameters\\":{\\"input.$\\":\\"$\\"},\\"Next\\":\\"Normalize Text\\"},\\"Normalize Text\\":{\\"Next\\":\\"Text empty?\\",\\"Retry\\":[{\\"ErrorEquals\\":[\\"Lambda.ServiceException\\",\\"Lambda.AWSLambdaException\\",\\"Lambda.SdkClientException\\"],\\"IntervalSeconds\\":2,\\"MaxAttempts\\":6,\\"BackoffRate\\":2}],\\"Type\\":\\"Task\\",\\"InputPath\\":\\"$.input\\",\\"ResultSelector\\":{\\"input.$\\":\\"$\\",\\"CacheKey.$\\":\\"$.CacheKey\\"},\\"Resource\\":\\"",
              Object {
                "Fn::GetAtt": Array [
                  "ComprehendJobNormalizeFunction49B1DB7D",
                  "Arn",
                ],
              },
              "\\"},\\"Text empty?\\":{\\"Type\\":\\"Choice\\",\\"Choices\\":[{\\"Variable\\":\\"$.input.Text\\",\\"StringEquals\\":\\"\\",\\"Next\\":\\"EmpryResponse\\"}],\\"Default\\":\\"Get Cache\\"},\\"Get Cache\\":{\\"Next\\":\\"CacheHit?\\",\\"Retry\\":[{\\"ErrorEquals\\":[\\"States.ALL\\"],\\"MaxAttempts\\":2}],\\"Type\\":\\"Task\\",\\"InputPath\\":\\"$.CacheKey\\",\\"ResultPath\\":\\"$.Cache\\",\\"Resource\\":\\"arn:",
              Object {
                "Ref": "AWS::Partition",
              },
              ":states:::dynamodb:getItem\\",\\"Parameters\\":{\\"Key\\":{\\"id\\":{\\"S.$\\":\\"$\\"}},\\"TableName\\":\\"",
              Object {
                "Ref": "ComprehendJobCacheTable2D64C528",
              },
              "\\",\\"ConsistentRead\\":false}},\\"CacheHit?\\":{\\"Type\\":\\"Choice\\",\\"Choices\\":[{\\"Variable\\":\\"$.Cache.Item.value.B\\",\\"IsPresent\\":true,\\"Next\\":\\"Decode Cache\\"}],\\"Default\\":\\"LanguageCode supported?\\"},\\"LanguageCode supported?\\":{\\"Type\\":\\"Choice\\",\\"Choices\\":[{\\"Or\\":[{\\"Variable\\":\\"$.input.LanguageCode\\",\\"StringEquals\\":\\"ar\\"},{\\"Variable\\":\\"$.input.LanguageCode\\",\\"StringEquals\\":\\"hi\\"},{\\"Variable\\":\\"$.input.LanguageCode\\",\\"StringEquals\\":\\"ko\\"},{\\"Variable\\":\\"$.input.LanguageCode\\",\\"StringEquals\\":\\"zh-TW\\"},{\\"Variable\\":\\"$.input.LanguageCode\\",\\"StringEquals\\":\\"ja\\"},{\\"Variable\\":\\"$.input.LanguageCode\\",\\"StringEquals\\":\\"zh\\"},{\\"Variable\\":\\"$.input.LanguageCode\\",\\"StringEquals\\":\\"de\\"},{\\"Variable\\":\\"$.input.LanguageCode\\",\\"StringEquals\\":\\"pt\\"},{\\"Variable\\":\\"$.input.LanguageCode\\",\\"StringEquals\\":\\"en\\"},{\\"Variable\\":\\"$.input.LanguageCode\\",\\"StringEquals\\":\\"it\\"},{\\"Variable\\":\\"$.input.LanguageCode\\",\\"StringEquals\\":\\"fr\\"},{\\"Variable\\":\\"$.input.LanguageCode\\",\\"StringEquals\\":\\"es\\"}],\\"Next\\":\\"Detection\\"}],\\"Default\\":\\"Translate\\"},\\"Translate\\":{\\"Next\\":\\"Detection\\",\\"Retry\\":[{\\"ErrorEquals\\":[\\"States.ALL\\"],\\"MaxAttempts\\":1}],\\"Catch\\":[{\\"ErrorEquals\\":[\\"States.ALL\\"],\\"ResultPath\\":\\"$.error\\",\\"Next\\":\\"EmpryResponse\\"}],\\"Type\\":\\"Task\\",\\"InputPath\\":\\"$.input\\",\\"ResultPath\\":\\"$.input\\",\\"ResultSelector\\":{\\"Text.$\\":\\"$.TranslatedText\\",\\"LanguageCode\\":\\"en\\"},\\"Resource\\":\\"arn:",
              Object {
                "Ref": "AWS::Partition",
              },
              ":states:::aws-sdk:translate:translateText\\",\\"Parameters\\":{\\"Text.$\\":\\"$.Text\\",\\"SourceLanguageCode\\":\\"auto\\",\\"TargetLanguageCode\\":\\"en\\"}},\\"Detection\\":{\\"Type\\":\\"Parallel\\",\\"ResultPath\\":\\"$.Comprehend\\",\\"Next\\":\\"Generate Response\\",\\"InputPath\\":\\"$.input\\",\\"Branches\\":[{\\"StartAt\\":\\"Detect Entities\\",\\"States\\":{\\"Detect Entities\\":{\\"End\\":true,\\"Retry\\":[{\\"ErrorEquals\\":[\\"States.ALL\\"],\\"MaxAttempts\\":20}],\\"Type\\":\\"Task\\",\\"Resource\\":\\"arn:",
              Object {
                "Ref": "AWS::Partition",
              },
              ":states:::aws-sdk:comprehend:detectEntities\\",\\"Parameters\\":{\\"Text.$\\":\\"$.Text\\",\\"LanguageCode.$\\":\\"$.LanguageCode\\"}}}},{\\"StartAt\\":\\"Detect Sentiment\\",\\"States\\":{\\"Detect Sentiment\\":{\\"End\\":true,\\"Retry\\":[{\\"ErrorEquals\\":[\\"States.ALL\\"],\\"MaxAttempts\\":20}],\\"Type\\":\\"Task\\",\\"Resource\\":\\"arn:",
              Object {
                "Ref": "AWS::Partition",
              },
              ":states:::aws-sdk:comprehend:detectSentiment\\",\\"Parameters\\":{\\"Text.$\\":\\"$.Text\\",\\"LanguageCode.$\\":\\"$.LanguageCode\\"}}}}],\\"ResultSelector\\":{\\"Entities.$\\":\\"$[0].Entities\\",\\"Sentiment.$\\":\\"$[1].Sentiment\\",\\"SentimentScore.$\\":\\"$[1].SentimentScore\\"}},\\"Generate Response\\":{\\"Type\\":\\"Pass\\",\\"ResultPath\\":\\"$.Response\\",\\"Parameters\\":{\\"NormalizedText.$\\":\\"$.input.Text\\",\\"Entities.$\\":\\"$.Comprehend.Entities\\",\\"Sentiment.$\\":\\"$.Comprehend.Sentiment\\",\\"SentimentScore.$\\":\\"$.Comprehend.SentimentScore\\"},\\"Next\\":\\"Generate CacheValue\\"},\\"Generate CacheValue\\":{\\"Next\\":\\"Store Cache\\",\\"Retry\\":[{\\"ErrorEquals\\":[\\"Lambda.ServiceException\\",\\"Lambda.AWSLambdaException\\",\\"Lambda.SdkClientException\\"],\\"IntervalSeconds\\":2,\\"MaxAttempts\\":6,\\"BackoffRate\\":2}],\\"Type\\":\\"Task\\",\\"InputPath\\":\\"$.Response\\",\\"ResultPath\\":\\"$.Cache\\",\\"Resource\\":\\"",
              Object {
                "Fn::GetAtt": Array [
                  "ComprehendJobB64EncodeFunctionE10510B6",
                  "Arn",
                ],
              },
              "\\"},\\"Store Cache\\":{\\"End\\":true,\\"Retry\\":[{\\"ErrorEquals\\":[\\"States.ALL\\"],\\"MaxAttempts\\":2}],\\"Type\\":\\"Task\\",\\"OutputPath\\":\\"$.Response\\",\\"ResultPath\\":\\"$.tmp\\",\\"Resource\\":\\"arn:",
              Object {
                "Ref": "AWS::Partition",
              },
              ":states:::dynamodb:putItem\\",\\"Parameters\\":{\\"Item\\":{\\"id\\":{\\"S.$\\":\\"$.CacheKey\\"},\\"value\\":{\\"B.$\\":\\"$.Cache.Value\\"},\\"expire\\":{\\"N.$\\":\\"$.Cache.Expire\\"}},\\"TableName\\":\\"",
              Object {
                "Ref": "ComprehendJobCacheTable2D64C528",
              },
              "\\"}},\\"EmpryResponse\\":{\\"Type\\":\\"Pass\\",\\"Parameters\\":{\\"NormalizedText.$\\":\\"$.input.Text\\"},\\"End\\":true},\\"Decode Cache\\":{\\"End\\":true,\\"Retry\\":[{\\"ErrorEquals\\":[\\"Lambda.ServiceException\\",\\"Lambda.AWSLambdaException\\",\\"Lambda.SdkClientException\\"],\\"IntervalSeconds\\":2,\\"MaxAttempts\\":6,\\"BackoffRate\\":2}],\\"Type\\":\\"Task\\",\\"InputPath\\":\\"$.Cache.Item.value.B\\",\\"Resource\\":\\"",
              Object {
                "Fn::GetAtt": Array [
                  "ComprehendJobB64DecodeFunctionCFAE8AF0",
                  "Arn",
                ],
              },
              "\\"}}}",
            ],
          ],
        },
        "LoggingConfiguration": Object {
          "Destinations": Array [
            Object {
              "CloudWatchLogsLogGroup": Object {
                "LogGroupArn": Object {
                  "Fn::GetAtt": Array [
                    "ComprehendJobLogs46527FF7",
                    "Arn",
                  ],
                },
              },
            },
          ],
          "Level": "ERROR",
        },
        "RoleArn": Object {
          "Fn::GetAtt": Array [
            "ComprehendJobStateMachineRole8E097225",
            "Arn",
          ],
        },
        "StateMachineType": "EXPRESS",
        "TracingConfiguration": Object {
          "Enabled": true,
        },
      },
      "Type": "AWS::StepFunctions::StateMachine",
    },
    "ComprehendJobStateMachineRole8E097225": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": Object {
                  "Fn::FindInMap": Array [
                    "ServiceprincipalMap",
                    Object {
                      "Ref": "AWS::Region",
                    },
                    "states",
                  ],
                },
              },
            },
          ],
          "Version": "2012-10-17",
        },
      },
      "Type": "AWS::IAM::Role",
    },
    "ComprehendJobStateMachineRoleDefaultPolicyF1625302": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": Array [
                "logs:CreateLogDelivery",
                "logs:GetLogDelivery",
                "logs:UpdateLogDelivery",
                "logs:DeleteLogDelivery",
                "logs:ListLogDeliveries",
                "logs:PutResourcePolicy",
                "logs:DescribeResourcePolicies",
                "logs:DescribeLogGroups",
              ],
              "Effect": "Allow",
              "Resource": "*",
            },
            Object {
              "Action": Array [
                "xray:PutTraceSegments",
                "xray:PutTelemetryRecords",
                "xray:GetSamplingRules",
                "xray:GetSamplingTargets",
              ],
              "Effect": "Allow",
              "Resource": "*",
            },
            Object {
              "Action": "lambda:InvokeFunction",
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ComprehendJobNormalizeFunction49B1DB7D",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "ComprehendJobNormalizeFunction49B1DB7D",
                          "Arn",
                        ],
                      },
                      ":*",
                    ],
                  ],
                },
              ],
            },
            Object {
              "Action": "dynamodb:GetItem",
              "Effect": "Allow",
              "Resource": Object {
                "Fn::Join": Array [
                  "",
                  Array [
                    "arn:",
                    Object {
                      "Ref": "AWS::Partition",
                    },
                    ":dynamodb:",
                    Object {
                      "Ref": "AWS::Region",
                    },
                    ":",
                    Object {
                      "Ref": "AWS::AccountId",
                    },
                    ":table/",
                    Object {
                      "Ref": "ComprehendJobCacheTable2D64C528",
                    },
                  ],
                ],
              },
            },
            Object {
              "Action": "translate:TranslateText",
              "Effect": "Allow",
              "Resource": "*",
            },
            Object {
              "Action": "lambda:InvokeFunction",
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ComprehendJobB64EncodeFunctionE10510B6",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "ComprehendJobB64EncodeFunctionE10510B6",
                          "Arn",
                        ],
                      },
                      ":*",
                    ],
                  ],
                },
              ],
            },
            Object {
              "Action": "dynamodb:PutItem",
              "Effect": "Allow",
              "Resource": Object {
                "Fn::Join": Array [
                  "",
                  Array [
                    "arn:",
                    Object {
                      "Ref": "AWS::Partition",
                    },
                    ":dynamodb:",
                    Object {
                      "Ref": "AWS::Region",
                    },
                    ":",
                    Object {
                      "Ref": "AWS::AccountId",
                    },
                    ":table/",
                    Object {
                      "Ref": "ComprehendJobCacheTable2D64C528",
                    },
                  ],
                ],
              },
            },
            Object {
              "Action": "comprehend:DetectEntities",
              "Effect": "Allow",
              "Resource": "*",
            },
            Object {
              "Action": "comprehend:DetectSentiment",
              "Effect": "Allow",
              "Resource": "*",
            },
            Object {
              "Action": "lambda:InvokeFunction",
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "ComprehendJobB64DecodeFunctionCFAE8AF0",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "ComprehendJobB64DecodeFunctionCFAE8AF0",
                          "Arn",
                        ],
                      },
                      ":*",
                    ],
                  ],
                },
              ],
            },
            Object {
              "Action": "comprehend:DetectDominantLanguage",
              "Effect": "Allow",
              "Resource": "*",
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "ComprehendJobStateMachineRoleDefaultPolicyF1625302",
        "Roles": Array [
          Object {
            "Ref": "ComprehendJobStateMachineRole8E097225",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C81C01536": Object {
      "DependsOn": Array [
        "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRoleDefaultPolicy88902FDF",
        "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265",
      ],
      "Properties": Object {
        "Code": Object {
          "S3Bucket": Object {
            "Fn::Sub": "cdk-hnb659fds-assets-\${AWS::AccountId}-\${AWS::Region}",
          },
          "S3Key": "2bc265c5e0569aeb24a6349c15bd54e76e845892376515e036627ab0cc70bb64.zip",
        },
        "Handler": "index.handler",
        "Layers": Array [
          Object {
            "Ref": "OpenSearchPackagesDeploymentAwsCliLayerADF8F738",
          },
        ],
        "Role": Object {
          "Fn::GetAtt": Array [
            "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265",
            "Arn",
          ],
        },
        "Runtime": "python3.9",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRoleDefaultPolicy88902FDF": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": Array [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      "arn:",
                      Object {
                        "Ref": "AWS::Partition",
                      },
                      ":s3:::",
                      Object {
                        "Fn::Sub": "cdk-hnb659fds-assets-\${AWS::AccountId}-\${AWS::Region}",
                      },
                    ],
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      "arn:",
                      Object {
                        "Ref": "AWS::Partition",
                      },
                      ":s3:::",
                      Object {
                        "Fn::Sub": "cdk-hnb659fds-assets-\${AWS::AccountId}-\${AWS::Region}",
                      },
                      "/*",
                    ],
                  ],
                },
              ],
            },
            Object {
              "Action": Array [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*",
                "s3:DeleteObject*",
                "s3:PutObject",
                "s3:PutObjectLegalHold",
                "s3:PutObjectRetention",
                "s3:PutObjectTagging",
                "s3:PutObjectVersionTagging",
                "s3:Abort*",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "Bucket83908E77",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "Bucket83908E77",
                          "Arn",
                        ],
                      },
                      "/*",
                    ],
                  ],
                },
              ],
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRoleDefaultPolicy88902FDF",
        "Roles": Array [
          Object {
            "Ref": "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "DashboardAppLogs4099E214": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "RetentionInDays": 30,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Delete",
    },
    "DashboardAuditLogsD6A35512": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "RetentionInDays": 30,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Delete",
    },
    "DashboardDomainAccessPolicyCustomResourcePolicy63DD89EF": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "es:UpdateDomainConfig",
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "DashboardDomainED696CAB",
                  "Arn",
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "DashboardDomainAccessPolicyCustomResourcePolicy63DD89EF",
        "Roles": Array [
          Object {
            "Ref": "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "DashboardDomainAccessPolicyD0E20C1B": Object {
      "DeletionPolicy": "Delete",
      "DependsOn": Array [
        "DashboardDomainAccessPolicyCustomResourcePolicy63DD89EF",
      ],
      "Properties": Object {
        "Create": Object {
          "Fn::Join": Array [
            "",
            Array [
              "{\\"action\\":\\"updateDomainConfig\\",\\"service\\":\\"OpenSearch\\",\\"parameters\\":{\\"DomainName\\":\\"",
              Object {
                "Ref": "DashboardDomainED696CAB",
              },
              "\\",\\"AccessPolicies\\":\\"{\\\\\\"Statement\\\\\\":[{\\\\\\"Action\\\\\\":\\\\\\"es:ESHttp*\\\\\\",\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\",\\\\\\"Principal\\\\\\":{\\\\\\"AWS\\\\\\":\\\\\\"*\\\\\\"},\\\\\\"Resource\\\\\\":\\\\\\"*\\\\\\"}],\\\\\\"Version\\\\\\":\\\\\\"2012-10-17\\\\\\"}\\"},\\"outputPaths\\":[\\"DomainConfig.AccessPolicies\\"],\\"physicalResourceId\\":{\\"id\\":\\"",
              Object {
                "Ref": "DashboardDomainED696CAB",
              },
              "AccessPolicy\\"}}",
            ],
          ],
        },
        "InstallLatestAwsSdk": true,
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "AWS679f53fac002430cb0da5b7982bd22872D164C4C",
            "Arn",
          ],
        },
        "Update": Object {
          "Fn::Join": Array [
            "",
            Array [
              "{\\"action\\":\\"updateDomainConfig\\",\\"service\\":\\"OpenSearch\\",\\"parameters\\":{\\"DomainName\\":\\"",
              Object {
                "Ref": "DashboardDomainED696CAB",
              },
              "\\",\\"AccessPolicies\\":\\"{\\\\\\"Statement\\\\\\":[{\\\\\\"Action\\\\\\":\\\\\\"es:ESHttp*\\\\\\",\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\",\\\\\\"Principal\\\\\\":{\\\\\\"AWS\\\\\\":\\\\\\"*\\\\\\"},\\\\\\"Resource\\\\\\":\\\\\\"*\\\\\\"}],\\\\\\"Version\\\\\\":\\\\\\"2012-10-17\\\\\\"}\\"},\\"outputPaths\\":[\\"DomainConfig.AccessPolicies\\"],\\"physicalResourceId\\":{\\"id\\":\\"",
              Object {
                "Ref": "DashboardDomainED696CAB",
              },
              "AccessPolicy\\"}}",
            ],
          ],
        },
      },
      "Type": "Custom::OpenSearchAccessPolicy",
      "UpdateReplacePolicy": "Delete",
    },
    "DashboardDomainBulkOperationRole5DCB8F6B": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainProviderframeworkonEvent09950933",
            "Arn",
          ],
        },
        "body": Object {
          "cluster_permissions": Array [
            "indices:data/write/bulk",
          ],
          "description": "Provide the minimum permissions for a bulk operation user",
          "index_permissions": Array [
            Object {
              "allowed_actions": Array [
                "write",
                "create_index",
              ],
              "index_patterns": Array [
                "tweets-*",
              ],
            },
          ],
        },
        "host": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainED696CAB",
            "DomainEndpoint",
          ],
        },
        "name": "bulk_operation",
        "path": "_plugins/_security/api/roles/",
      },
      "Type": "Custom::OpenSearchRole",
      "UpdateReplacePolicy": "Delete",
    },
    "DashboardDomainBulkOperationRoleMapping1B903E09": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainProviderframeworkonEvent09950933",
            "Arn",
          ],
        },
        "body": Object {
          "backend_roles": Array [
            Object {
              "Fn::GetAtt": Array [
                "OpenSearchLoaderFunctionServiceRole32276686",
                "Arn",
              ],
            },
          ],
        },
        "host": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainED696CAB",
            "DomainEndpoint",
          ],
        },
        "name": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainBulkOperationRole5DCB8F6B",
            "Name",
          ],
        },
        "path": "_plugins/_security/api/rolesmapping/",
      },
      "Type": "Custom::OpenSearchRoleMapping",
      "UpdateReplacePolicy": "Delete",
    },
    "DashboardDomainConsoleRoleF2990B82": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainProviderframeworkonEvent09950933",
            "Arn",
          ],
        },
        "body": Object {
          "cluster_permissions": Array [
            "cluster:monitor/health",
          ],
          "description": "Provide the minimum permissions for aws console user",
          "index_permissions": Array [
            Object {
              "allowed_actions": Array [
                "indices:monitor/stats",
                "indices:admin/mappings/get",
              ],
              "index_patterns": Array [
                "*",
              ],
            },
          ],
        },
        "host": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainED696CAB",
            "DomainEndpoint",
          ],
        },
        "name": "aws_console",
        "path": "_plugins/_security/api/roles/",
      },
      "Type": "Custom::OpenSearchRole",
      "UpdateReplacePolicy": "Delete",
    },
    "DashboardDomainConsoleRoleMappingC523696E": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainProviderframeworkonEvent09950933",
            "Arn",
          ],
        },
        "body": Object {
          "backend_roles": Array [
            Object {
              "Fn::Join": Array [
                "",
                Array [
                  "arn:aws:iam::",
                  Object {
                    "Ref": "AWS::AccountId",
                  },
                  ":role/*",
                ],
              ],
            },
          ],
        },
        "host": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainED696CAB",
            "DomainEndpoint",
          ],
        },
        "name": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainConsoleRoleF2990B82",
            "Name",
          ],
        },
        "path": "_plugins/_security/api/rolesmapping/",
      },
      "Type": "Custom::OpenSearchRoleMapping",
      "UpdateReplacePolicy": "Delete",
    },
    "DashboardDomainDefaultSnapshotRepoEFE66608": Object {
      "DeletionPolicy": "Delete",
      "DependsOn": Array [
        "DashboardSnapshotRoleDefaultPolicyEF231DDD",
        "DashboardSnapshotRole792BAAA0",
      ],
      "Properties": Object {
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainProviderframeworkonEvent09950933",
            "Arn",
          ],
        },
        "body": Object {
          "settings": Object {
            "base_path": "opensearch/snapshot",
            "bucket": Object {
              "Ref": "Bucket83908E77",
            },
            "role_arn": Object {
              "Fn::GetAtt": Array [
                "DashboardSnapshotRole792BAAA0",
                "Arn",
              ],
            },
          },
          "type": "s3",
        },
        "host": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainED696CAB",
            "DomainEndpoint",
          ],
        },
        "name": "default",
        "path": "_snapshot/",
      },
      "Type": "Custom::OpenSearchSnapshotRepo",
      "UpdateReplacePolicy": "Delete",
    },
    "DashboardDomainED696CAB": Object {
      "DeletionPolicy": "Retain",
      "DependsOn": Array [
        "DashboardDomainESLogGroupPolicyc8fa6d20cfff60d0c384a83a18559bc5232144e611CustomResourcePolicy49AD4ACE",
        "DashboardDomainESLogGroupPolicyc8fa6d20cfff60d0c384a83a18559bc5232144e611830181CB",
      ],
      "Properties": Object {
        "AdvancedSecurityOptions": Object {
          "Enabled": true,
          "InternalUserDatabaseEnabled": false,
          "MasterUserOptions": Object {
            "MasterUserARN": Object {
              "Fn::GetAtt": Array [
                "DashboardMasterUserRoleE088A648",
                "Arn",
              ],
            },
          },
        },
        "ClusterConfig": Object {
          "DedicatedMasterCount": 3,
          "DedicatedMasterEnabled": true,
          "DedicatedMasterType": "m6g.large.search",
          "InstanceCount": 3,
          "InstanceType": "r6gd.xlarge.search",
          "ZoneAwarenessConfig": Object {
            "AvailabilityZoneCount": 3,
          },
          "ZoneAwarenessEnabled": true,
        },
        "DomainEndpointOptions": Object {
          "EnforceHTTPS": true,
          "TLSSecurityPolicy": "Policy-Min-TLS-1-0-2019-07",
        },
        "EBSOptions": Object {
          "EBSEnabled": false,
        },
        "EncryptionAtRestOptions": Object {
          "Enabled": true,
        },
        "EngineVersion": "OpenSearch_2.3",
        "LogPublishingOptions": Object {
          "AUDIT_LOGS": Object {
            "CloudWatchLogsLogGroupArn": Object {
              "Fn::GetAtt": Array [
                "DashboardAuditLogsD6A35512",
                "Arn",
              ],
            },
            "Enabled": true,
          },
          "ES_APPLICATION_LOGS": Object {
            "CloudWatchLogsLogGroupArn": Object {
              "Fn::GetAtt": Array [
                "DashboardAppLogs4099E214",
                "Arn",
              ],
            },
            "Enabled": true,
          },
          "INDEX_SLOW_LOGS": Object {
            "CloudWatchLogsLogGroupArn": Object {
              "Fn::GetAtt": Array [
                "DashboardSlowIndexLogs61DDE73B",
                "Arn",
              ],
            },
            "Enabled": true,
          },
          "SEARCH_SLOW_LOGS": Object {
            "CloudWatchLogsLogGroupArn": Object {
              "Fn::GetAtt": Array [
                "DashboardSlowSearchLogsD1D4DEE1",
                "Arn",
              ],
            },
            "Enabled": true,
          },
        },
        "NodeToNodeEncryptionOptions": Object {
          "Enabled": true,
        },
      },
      "Type": "AWS::OpenSearchService::Domain",
      "UpdatePolicy": Object {
        "EnableVersionUpgrade": true,
      },
      "UpdateReplacePolicy": "Retain",
    },
    "DashboardDomainESLogGroupPolicyc8fa6d20cfff60d0c384a83a18559bc5232144e611830181CB": Object {
      "DeletionPolicy": "Delete",
      "DependsOn": Array [
        "DashboardDomainESLogGroupPolicyc8fa6d20cfff60d0c384a83a18559bc5232144e611CustomResourcePolicy49AD4ACE",
      ],
      "Properties": Object {
        "Create": Object {
          "Fn::Join": Array [
            "",
            Array [
              "{\\"service\\":\\"CloudWatchLogs\\",\\"action\\":\\"putResourcePolicy\\",\\"parameters\\":{\\"policyName\\":\\"ESLogPolicyc8fa6d20cfff60d0c384a83a18559bc5232144e611\\",\\"policyDocument\\":\\"{\\\\\\"Statement\\\\\\":[{\\\\\\"Action\\\\\\":[\\\\\\"logs:PutLogEvents\\\\\\",\\\\\\"logs:CreateLogStream\\\\\\"],\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\",\\\\\\"Principal\\\\\\":{\\\\\\"Service\\\\\\":\\\\\\"es.amazonaws.com\\\\\\"},\\\\\\"Resource\\\\\\":[\\\\\\"",
              Object {
                "Fn::GetAtt": Array [
                  "DashboardSlowSearchLogsD1D4DEE1",
                  "Arn",
                ],
              },
              "\\\\\\",\\\\\\"",
              Object {
                "Fn::GetAtt": Array [
                  "DashboardSlowIndexLogs61DDE73B",
                  "Arn",
                ],
              },
              "\\\\\\",\\\\\\"",
              Object {
                "Fn::GetAtt": Array [
                  "DashboardAppLogs4099E214",
                  "Arn",
                ],
              },
              "\\\\\\",\\\\\\"",
              Object {
                "Fn::GetAtt": Array [
                  "DashboardAuditLogsD6A35512",
                  "Arn",
                ],
              },
              "\\\\\\"]}],\\\\\\"Version\\\\\\":\\\\\\"2012-10-17\\\\\\"}\\"},\\"physicalResourceId\\":{\\"id\\":\\"ESLogGroupPolicyc8fa6d20cfff60d0c384a83a18559bc5232144e611\\"}}",
            ],
          ],
        },
        "Delete": "{\\"service\\":\\"CloudWatchLogs\\",\\"action\\":\\"deleteResourcePolicy\\",\\"parameters\\":{\\"policyName\\":\\"ESLogPolicyc8fa6d20cfff60d0c384a83a18559bc5232144e611\\"},\\"ignoreErrorCodesMatching\\":\\"ResourceNotFoundException\\"}",
        "InstallLatestAwsSdk": true,
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "AWS679f53fac002430cb0da5b7982bd22872D164C4C",
            "Arn",
          ],
        },
        "Update": Object {
          "Fn::Join": Array [
            "",
            Array [
              "{\\"service\\":\\"CloudWatchLogs\\",\\"action\\":\\"putResourcePolicy\\",\\"parameters\\":{\\"policyName\\":\\"ESLogPolicyc8fa6d20cfff60d0c384a83a18559bc5232144e611\\",\\"policyDocument\\":\\"{\\\\\\"Statement\\\\\\":[{\\\\\\"Action\\\\\\":[\\\\\\"logs:PutLogEvents\\\\\\",\\\\\\"logs:CreateLogStream\\\\\\"],\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\",\\\\\\"Principal\\\\\\":{\\\\\\"Service\\\\\\":\\\\\\"es.amazonaws.com\\\\\\"},\\\\\\"Resource\\\\\\":[\\\\\\"",
              Object {
                "Fn::GetAtt": Array [
                  "DashboardSlowSearchLogsD1D4DEE1",
                  "Arn",
                ],
              },
              "\\\\\\",\\\\\\"",
              Object {
                "Fn::GetAtt": Array [
                  "DashboardSlowIndexLogs61DDE73B",
                  "Arn",
                ],
              },
              "\\\\\\",\\\\\\"",
              Object {
                "Fn::GetAtt": Array [
                  "DashboardAppLogs4099E214",
                  "Arn",
                ],
              },
              "\\\\\\",\\\\\\"",
              Object {
                "Fn::GetAtt": Array [
                  "DashboardAuditLogsD6A35512",
                  "Arn",
                ],
              },
              "\\\\\\"]}],\\\\\\"Version\\\\\\":\\\\\\"2012-10-17\\\\\\"}\\"},\\"physicalResourceId\\":{\\"id\\":\\"ESLogGroupPolicyc8fa6d20cfff60d0c384a83a18559bc5232144e611\\"}}",
            ],
          ],
        },
      },
      "Type": "Custom::CloudwatchLogResourcePolicy",
      "UpdateReplacePolicy": "Delete",
    },
    "DashboardDomainESLogGroupPolicyc8fa6d20cfff60d0c384a83a18559bc5232144e611CustomResourcePolicy49AD4ACE": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "logs:PutResourcePolicy",
              "Effect": "Allow",
              "Resource": "*",
            },
            Object {
              "Action": "logs:DeleteResourcePolicy",
              "Effect": "Allow",
              "Resource": "*",
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "DashboardDomainESLogGroupPolicyc8fa6d20cfff60d0c384a83a18559bc5232144e611CustomResourcePolicy49AD4ACE",
        "Roles": Array [
          Object {
            "Ref": "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "DashboardDomainKuromojiComponentTemplate715A67D0": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainProviderframeworkonEvent09950933",
            "Arn",
          ],
        },
        "body": Object {
          "template": Object {
            "settings": Object {
              "index": Object {
                "analysis": Object {
                  "analyzer": Object {
                    "kuromoji_user_dic": Object {
                      "type": "kuromoji",
                    },
                  },
                },
              },
            },
          },
        },
        "host": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainED696CAB",
            "DomainEndpoint",
          ],
        },
        "name": "kuromoji_user_dic",
        "path": "_component_template/",
      },
      "Type": "Custom::OpenSearchComponentTemplate",
      "UpdateReplacePolicy": "Delete",
    },
    "DashboardDomainOpenSearchResourceFunction6FC3C0C1": Object {
      "DependsOn": Array [
        "DashboardMasterUserRoleDefaultPolicy292966BE",
        "DashboardMasterUserRoleE088A648",
      ],
      "Properties": Object {
        "Architectures": Array [
          "arm64",
        ],
        "Code": Object {
          "S3Bucket": Object {
            "Fn::Sub": "cdk-hnb659fds-assets-\${AWS::AccountId}-\${AWS::Region}",
          },
          "S3Key": "c4254b478647935517ae7e4cd6d7562b4d1aad1df815026570bd09b436e810e7.zip",
        },
        "Description": "Lambda-backed custom resources - OpenSearch resources",
        "Environment": Object {
          "Variables": Object {
            "AWS_NODEJS_CONNECTION_REUSE_ENABLED": "1",
          },
        },
        "Handler": "index.handler",
        "Role": Object {
          "Fn::GetAtt": Array [
            "DashboardMasterUserRoleE088A648",
            "Arn",
          ],
        },
        "Runtime": "nodejs18.x",
        "Timeout": 300,
      },
      "Type": "AWS::Lambda::Function",
    },
    "DashboardDomainProviderframeworkonEvent09950933": Object {
      "DependsOn": Array [
        "DashboardDomainProviderframeworkonEventServiceRoleDefaultPolicy10CA9520",
        "DashboardDomainProviderframeworkonEventServiceRole84E58F63",
      ],
      "Properties": Object {
        "Code": Object {
          "S3Bucket": Object {
            "Fn::Sub": "cdk-hnb659fds-assets-\${AWS::AccountId}-\${AWS::Region}",
          },
          "S3Key": "6ff23d2800aac27308e31c227529dc13854507c3b2598d2433fcf82604fa054d.zip",
        },
        "Description": "AWS CDK resource provider framework - onEvent (test/Dashboard/Domain/Provider)",
        "Environment": Object {
          "Variables": Object {
            "USER_ON_EVENT_FUNCTION_ARN": Object {
              "Fn::GetAtt": Array [
                "DashboardDomainOpenSearchResourceFunction6FC3C0C1",
                "Arn",
              ],
            },
          },
        },
        "Handler": "framework.onEvent",
        "Role": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainProviderframeworkonEventServiceRole84E58F63",
            "Arn",
          ],
        },
        "Runtime": "nodejs14.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "DashboardDomainProviderframeworkonEventServiceRole84E58F63": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "DashboardDomainProviderframeworkonEventServiceRoleDefaultPolicy10CA9520": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "lambda:InvokeFunction",
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "DashboardDomainOpenSearchResourceFunction6FC3C0C1",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "DashboardDomainOpenSearchResourceFunction6FC3C0C1",
                          "Arn",
                        ],
                      },
                      ":*",
                    ],
                  ],
                },
              ],
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "DashboardDomainProviderframeworkonEventServiceRoleDefaultPolicy10CA9520",
        "Roles": Array [
          Object {
            "Ref": "DashboardDomainProviderframeworkonEventServiceRole84E58F63",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "DashboardDomainSnapshotRoleRoleMapping32CD1178": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainProviderframeworkonEvent09950933",
            "Arn",
          ],
        },
        "body": Object {
          "backend_roles": Array [
            Object {
              "Fn::GetAtt": Array [
                "DashboardSnapshotRole792BAAA0",
                "Arn",
              ],
            },
          ],
        },
        "host": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainED696CAB",
            "DomainEndpoint",
          ],
        },
        "name": "manage_snapshots",
        "path": "_plugins/_security/api/rolesmapping/",
      },
      "Type": "Custom::OpenSearchRoleMapping",
      "UpdateReplacePolicy": "Delete",
    },
    "DashboardDomainSocialAnalyticsReadOnlyRoleD23D3D87": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainProviderframeworkonEvent09950933",
            "Arn",
          ],
        },
        "body": Object {
          "cluster_permissions": Array [
            "cluster_composite_ops_ro",
            "cluster:admin/opendistro/reports/definition/create",
            "cluster:admin/opendistro/reports/definition/update",
            "cluster:admin/opendistro/reports/definition/on_demand",
            "cluster:admin/opendistro/reports/definition/delete",
            "cluster:admin/opendistro/reports/definition/get",
            "cluster:admin/opendistro/reports/definition/list",
            "cluster:admin/opendistro/reports/instance/list",
            "cluster:admin/opendistro/reports/instance/get",
            "cluster:admin/opendistro/reports/menu/download",
          ],
          "description": "Provide the minimum permissions for all users",
          "index_permissions": Array [
            Object {
              "allowed_actions": Array [
                "read",
                "delete",
                "manage",
                "index",
              ],
              "index_patterns": Array [
                ".kibana",
                ".kibana_*",
                ".opensearch_dashboards",
                ".opensearch_dashboards_*",
              ],
            },
            Object {
              "allowed_actions": Array [
                "indices_all",
              ],
              "index_patterns": Array [
                ".tasks",
                ".management-beats",
              ],
            },
            Object {
              "allowed_actions": Array [
                "read",
                "indices_monitor",
              ],
              "index_patterns": Array [
                "tweets-*",
              ],
            },
          ],
          "tenant_permissions": Array [
            Object {
              "allowed_actions": Array [
                "kibana_all_read",
              ],
              "tenant_patterns": Array [
                "global_tenant",
              ],
            },
          ],
        },
        "host": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainED696CAB",
            "DomainEndpoint",
          ],
        },
        "name": "social_analytics_read_only",
        "path": "_plugins/_security/api/roles/",
      },
      "Type": "Custom::OpenSearchRole",
      "UpdateReplacePolicy": "Delete",
    },
    "DashboardDomainSocialAnalyticsReadOnlyRoleMappingE72B9FEA": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainProviderframeworkonEvent09950933",
            "Arn",
          ],
        },
        "body": Object {
          "backend_roles": Array [
            "*",
          ],
        },
        "host": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainED696CAB",
            "DomainEndpoint",
          ],
        },
        "name": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainSocialAnalyticsReadOnlyRoleD23D3D87",
            "Name",
          ],
        },
        "path": "_plugins/_security/api/rolesmapping/",
      },
      "Type": "Custom::OpenSearchRoleMapping",
      "UpdateReplacePolicy": "Delete",
    },
    "DashboardDomainTweetsTemplate35A526B1": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainProviderframeworkonEvent09950933",
            "Arn",
          ],
        },
        "body": Object {
          "composed_of": Array [
            Object {
              "Fn::GetAtt": Array [
                "DashboardDomainKuromojiComponentTemplate715A67D0",
                "Name",
              ],
            },
          ],
          "index_patterns": Array [
            "tweets-*",
          ],
          "template": Object {
            "mappings": Object {
              "_source": Object {
                "enabled": true,
              },
              "properties": Object {
                "author": Object {
                  "properties": Object {
                    "id": Object {
                      "type": "keyword",
                    },
                    "name": Object {
                      "type": "keyword",
                    },
                    "public_metrics": Object {
                      "properties": Object {
                        "followers_count": Object {
                          "type": "long",
                        },
                        "following_count": Object {
                          "type": "long",
                        },
                        "listed_count": Object {
                          "type": "long",
                        },
                        "tweet_count": Object {
                          "type": "long",
                        },
                      },
                    },
                    "url": Object {
                      "index": false,
                      "type": "keyword",
                    },
                    "username": Object {
                      "type": "keyword",
                    },
                    "verified": Object {
                      "type": "boolean",
                    },
                  },
                },
                "author_id": Object {
                  "type": "keyword",
                },
                "comprehend": Object {
                  "properties": Object {
                    "entities": Object {
                      "type": "keyword",
                    },
                    "sentiment": Object {
                      "type": "keyword",
                    },
                    "sentiment_score": Object {
                      "properties": Object {
                        "mixed": Object {
                          "type": "double",
                        },
                        "negative": Object {
                          "type": "double",
                        },
                        "neutral": Object {
                          "type": "double",
                        },
                        "positive": Object {
                          "type": "double",
                        },
                      },
                    },
                  },
                },
                "context_annotations": Object {
                  "properties": Object {
                    "domain": Object {
                      "type": "keyword",
                    },
                    "entity": Object {
                      "type": "keyword",
                    },
                  },
                },
                "conversation_id": Object {
                  "type": "keyword",
                },
                "created_at": Object {
                  "type": "date",
                },
                "created_at_year": Object {
                  "type": "keyword",
                },
                "entities": Object {
                  "properties": Object {
                    "annotation": Object {
                      "type": "keyword",
                    },
                    "cashtag": Object {
                      "type": "keyword",
                    },
                    "hashtag": Object {
                      "type": "keyword",
                    },
                    "mention": Object {
                      "type": "keyword",
                    },
                    "url": Object {
                      "properties": Object {
                        "description": Object {
                          "analyzer": "kuromoji_user_dic",
                          "type": "text",
                        },
                        "display_domain": Object {
                          "type": "keyword",
                        },
                        "display_url": Object {
                          "type": "keyword",
                        },
                        "expanded_url": Object {
                          "fielddata": true,
                          "fields": Object {
                            "raw": Object {
                              "type": "keyword",
                            },
                          },
                          "type": "text",
                        },
                        "title": Object {
                          "analyzer": "kuromoji_user_dic",
                          "fielddata": true,
                          "fields": Object {
                            "raw": Object {
                              "type": "keyword",
                            },
                          },
                          "type": "text",
                        },
                      },
                    },
                  },
                },
                "geo": Object {
                  "properties": Object {
                    "coordinates": Object {
                      "properties": Object {
                        "coordinates": Object {
                          "type": "geo_point",
                        },
                        "type": Object {
                          "type": "keyword",
                        },
                      },
                    },
                    "place_id": Object {
                      "type": "keyword",
                    },
                  },
                },
                "id": Object {
                  "type": "keyword",
                },
                "in_reply_to_user_id": Object {
                  "type": "keyword",
                },
                "lang": Object {
                  "type": "keyword",
                },
                "normalized_text": Object {
                  "analyzer": "kuromoji_user_dic",
                  "type": "text",
                },
                "possibly_sensitive": Object {
                  "type": "boolean",
                },
                "public_metrics": Object {
                  "properties": Object {
                    "like_count": Object {
                      "type": "long",
                    },
                    "quote_count": Object {
                      "type": "long",
                    },
                    "reply_count": Object {
                      "type": "long",
                    },
                    "retweet_count": Object {
                      "type": "long",
                    },
                  },
                },
                "referenced_tweets": Object {
                  "properties": Object {
                    "id": Object {
                      "type": "keyword",
                    },
                    "type": Object {
                      "type": "keyword",
                    },
                  },
                },
                "reply_settings": Object {
                  "type": "keyword",
                },
                "source": Object {
                  "type": "keyword",
                },
                "text": Object {
                  "analyzer": "kuromoji_user_dic",
                  "type": "text",
                },
                "updated_at": Object {
                  "format": "epoch_second",
                  "type": "date",
                },
                "url": Object {
                  "index": false,
                  "type": "keyword",
                },
              },
            },
            "settings": Object {
              "index": Object {
                "number_of_replicas": 1,
                "number_of_shards": 3,
              },
            },
          },
        },
        "host": Object {
          "Fn::GetAtt": Array [
            "DashboardDomainED696CAB",
            "DomainEndpoint",
          ],
        },
        "name": "tweets",
        "path": "_index_template/",
      },
      "Type": "Custom::OpenSearchTemplate",
      "UpdateReplacePolicy": "Delete",
    },
    "DashboardMasterUserRoleDefaultPolicy292966BE": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "iam:PassRole",
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "DashboardSnapshotRole792BAAA0",
                  "Arn",
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "DashboardMasterUserRoleDefaultPolicy292966BE",
        "Roles": Array [
          Object {
            "Ref": "DashboardMasterUserRoleE088A648",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "DashboardMasterUserRoleE088A648": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "Description": "Master user for OpenSearch / fine-grained access control",
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "DashboardSlowIndexLogs61DDE73B": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "RetentionInDays": 30,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Delete",
    },
    "DashboardSlowSearchLogsD1D4DEE1": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "RetentionInDays": 30,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Delete",
    },
    "DashboardSnapshotRole792BAAA0": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "opensearchservice.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
      },
      "Type": "AWS::IAM::Role",
    },
    "DashboardSnapshotRoleDefaultPolicyEF231DDD": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "s3:ListBucket",
              "Effect": "Allow",
              "Resource": Object {
                "Fn::Join": Array [
                  "",
                  Array [
                    "arn:aws:s3:::",
                    Object {
                      "Ref": "Bucket83908E77",
                    },
                  ],
                ],
              },
            },
            Object {
              "Action": Array [
                "s3:GetObject",
                "s3:PutObject",
                "s3:DeleteObject",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::Join": Array [
                  "",
                  Array [
                    "arn:aws:s3:::",
                    Object {
                      "Ref": "Bucket83908E77",
                    },
                    "/opensearch/snapshot/*",
                  ],
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "DashboardSnapshotRoleDefaultPolicyEF231DDD",
        "Roles": Array [
          Object {
            "Ref": "DashboardSnapshotRole792BAAA0",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "DynamoLoaderFunctionDDDB5041": Object {
      "DependsOn": Array [
        "DynamoLoaderFunctionServiceRoleDefaultPolicy0FDF330E",
        "DynamoLoaderFunctionServiceRole3B9B210F",
      ],
      "Properties": Object {
        "Architectures": Array [
          "arm64",
        ],
        "Code": Object {
          "S3Bucket": Object {
            "Fn::Sub": "cdk-hnb659fds-assets-\${AWS::AccountId}-\${AWS::Region}",
          },
          "S3Key": "450475ddc553c5bfd05992b1e225682dec4ff1c5de7160e63dfcb333744b3140.zip",
        },
        "Description": "[SocialAnalytics] Tweet event processor to update DynamoDB",
        "Environment": Object {
          "Variables": Object {
            "APPCONFIG_BASE_URL": "http://localhost:2772/applications/test/environments/Production/configurations",
            "AWS_NODEJS_CONNECTION_REUSE_ENABLED": "1",
            "POWERTOOLS_METRICS_NAMESPACE": Object {
              "Ref": "AWS::StackName",
            },
            "POWERTOOLS_SERVICE_NAME": "DynamoLoaderFunction",
            "TWEET_TABLE_NAME": Object {
              "Ref": "TweetTable97F090DB",
            },
          },
        },
        "Handler": "index.handler",
        "Layers": Array [
          "arn:aws:lambda:us-west-2:359756378197:layer:AWS-AppConfig-Extension-Arm64:3",
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:aws:lambda:",
                Object {
                  "Ref": "AWS::Region",
                },
                ":580247275435:layer:LambdaInsightsExtension-Arm64:2",
              ],
            ],
          },
        ],
        "Role": Object {
          "Fn::GetAtt": Array [
            "DynamoLoaderFunctionServiceRole3B9B210F",
            "Arn",
          ],
        },
        "Runtime": "nodejs18.x",
        "Timeout": 5,
        "TracingConfig": Object {
          "Mode": "Active",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "DynamoLoaderFunctionServiceRole3B9B210F": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/CloudWatchLambdaInsightsExecutionRolePolicy",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "DynamoLoaderFunctionServiceRoleDefaultPolicy0FDF330E": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": Array [
                "appconfig:StartConfigurationSession",
                "appconfig:GetLatestConfiguration",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::Join": Array [
                  "",
                  Array [
                    "arn:",
                    Object {
                      "Ref": "AWS::Partition",
                    },
                    ":appconfig:",
                    Object {
                      "Ref": "AWS::Region",
                    },
                    ":",
                    Object {
                      "Ref": "AWS::AccountId",
                    },
                    ":application/",
                    Object {
                      "Ref": "AppConfigApplication559632A2",
                    },
                    "/environment/",
                    Object {
                      "Ref": "AppConfigApplicationProduction11A5678C",
                    },
                    "/configuration/*",
                  ],
                ],
              },
            },
            Object {
              "Action": Array [
                "xray:PutTraceSegments",
                "xray:PutTelemetryRecords",
              ],
              "Effect": "Allow",
              "Resource": "*",
            },
            Object {
              "Action": Array [
                "dynamodb:BatchWriteItem",
                "dynamodb:PutItem",
                "dynamodb:UpdateItem",
                "dynamodb:DeleteItem",
                "dynamodb:DescribeTable",
              ],
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "TweetTable97F090DB",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "TweetTable97F090DB",
                          "Arn",
                        ],
                      },
                      "/index/*",
                    ],
                  ],
                },
              ],
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "DynamoLoaderFunctionServiceRoleDefaultPolicy0FDF330E",
        "Roles": Array [
          Object {
            "Ref": "DynamoLoaderFunctionServiceRole3B9B210F",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "DynamoLoaderRule50A9E517": Object {
      "Properties": Object {
        "EventBusName": Object {
          "Ref": "TwitterEventBusC40513FF",
        },
        "EventPattern": Object {
          "detail": Object {
            "data": Object {
              "source": Array [
                Object {
                  "anything-but": Object {
                    "Fn::Split": Array [
                      ",",
                      Object {
                        "Fn::GetAtt": Array [
                          "twitterFilterSourceLabelsEC9A582C",
                          "Value",
                        ],
                      },
                    ],
                  },
                },
              ],
            },
          },
          "source": Array [
            "twitter.api.v2",
          ],
        },
        "State": "ENABLED",
        "Targets": Array [
          Object {
            "Arn": Object {
              "Fn::GetAtt": Array [
                "DynamoLoaderFunctionDDDB5041",
                "Arn",
              ],
            },
            "Id": "Target0",
          },
        ],
      },
      "Type": "AWS::Events::Rule",
    },
    "DynamoLoaderRuleAllowEventRuletestDynamoLoaderFunction595C0CA759FA82B9": Object {
      "Properties": Object {
        "Action": "lambda:InvokeFunction",
        "FunctionName": Object {
          "Fn::GetAtt": Array [
            "DynamoLoaderFunctionDDDB5041",
            "Arn",
          ],
        },
        "Principal": "events.amazonaws.com",
        "SourceArn": Object {
          "Fn::GetAtt": Array [
            "DynamoLoaderRule50A9E517",
            "Arn",
          ],
        },
      },
      "Type": "AWS::Lambda::Permission",
    },
    "OpenSearchLoaderFunction713423B0": Object {
      "DependsOn": Array [
        "OpenSearchLoaderFunctionServiceRoleDefaultPolicyE6EF7929",
        "OpenSearchLoaderFunctionServiceRole32276686",
      ],
      "Properties": Object {
        "Architectures": Array [
          "arm64",
        ],
        "Code": Object {
          "S3Bucket": Object {
            "Fn::Sub": "cdk-hnb659fds-assets-\${AWS::AccountId}-\${AWS::Region}",
          },
          "S3Key": "f2c5af61058e2e528c34cce2080d0e069968d4713262724195a3355f131579af.zip",
        },
        "Description": "[SocialAnalytics] OpenSearch Bulk Loader",
        "Environment": Object {
          "Variables": Object {
            "AWS_NODEJS_CONNECTION_REUSE_ENABLED": "1",
            "OPENSEARCH_DOMAIN_ENDPOINT": Object {
              "Fn::GetAtt": Array [
                "DashboardDomainED696CAB",
                "DomainEndpoint",
              ],
            },
            "POWERTOOLS_METRICS_NAMESPACE": Object {
              "Ref": "AWS::StackName",
            },
            "POWERTOOLS_SERVICE_NAME": "OpenSearchLoaderFunction",
          },
        },
        "Handler": "index.handler",
        "Layers": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:aws:lambda:",
                Object {
                  "Ref": "AWS::Region",
                },
                ":580247275435:layer:LambdaInsightsExtension-Arm64:2",
              ],
            ],
          },
        ],
        "MemorySize": 256,
        "Role": Object {
          "Fn::GetAtt": Array [
            "OpenSearchLoaderFunctionServiceRole32276686",
            "Arn",
          ],
        },
        "Runtime": "nodejs18.x",
        "Timeout": 60,
        "TracingConfig": Object {
          "Mode": "Active",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "OpenSearchLoaderFunctionDynamoDBEventSourcetestTweetTable04D57799E7FA3624": Object {
      "Properties": Object {
        "BatchSize": 100,
        "EventSourceArn": Object {
          "Fn::GetAtt": Array [
            "TweetTable97F090DB",
            "StreamArn",
          ],
        },
        "FunctionName": Object {
          "Ref": "OpenSearchLoaderFunction713423B0",
        },
        "MaximumBatchingWindowInSeconds": 5,
        "MaximumRecordAgeInSeconds": 86400,
        "StartingPosition": "LATEST",
      },
      "Type": "AWS::Lambda::EventSourceMapping",
    },
    "OpenSearchLoaderFunctionServiceRole32276686": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/CloudWatchLambdaInsightsExecutionRolePolicy",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "OpenSearchLoaderFunctionServiceRoleDefaultPolicyE6EF7929": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": Array [
                "xray:PutTraceSegments",
                "xray:PutTelemetryRecords",
              ],
              "Effect": "Allow",
              "Resource": "*",
            },
            Object {
              "Action": "dynamodb:ListStreams",
              "Effect": "Allow",
              "Resource": "*",
            },
            Object {
              "Action": Array [
                "dynamodb:DescribeStream",
                "dynamodb:GetRecords",
                "dynamodb:GetShardIterator",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "TweetTable97F090DB",
                  "StreamArn",
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "OpenSearchLoaderFunctionServiceRoleDefaultPolicyE6EF7929",
        "Roles": Array [
          Object {
            "Ref": "OpenSearchLoaderFunctionServiceRole32276686",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "OpenSearchPackagesDeploymentAwsCliLayerADF8F738": Object {
      "Properties": Object {
        "Content": Object {
          "S3Bucket": Object {
            "Fn::Sub": "cdk-hnb659fds-assets-\${AWS::AccountId}-\${AWS::Region}",
          },
          "S3Key": "5d8d1d0aacea23824c62f362e1e3c14b7dd14a31c71b53bfae4d14a6373c5510.zip",
        },
        "Description": "/opt/awscli/aws",
      },
      "Type": "AWS::Lambda::LayerVersion",
    },
    "OpenSearchPackagesDeploymentCustomResource4C6D16B3": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "DestinationBucketKeyPrefix": "opensearch/packages/",
        "DestinationBucketName": Object {
          "Ref": "Bucket83908E77",
        },
        "Prune": true,
        "ServiceToken": Object {
          "Fn::GetAtt": Array [
            "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C81C01536",
            "Arn",
          ],
        },
        "SourceBucketNames": Array [
          Object {
            "Fn::Sub": "cdk-hnb659fds-assets-\${AWS::AccountId}-\${AWS::Region}",
          },
        ],
        "SourceObjectKeys": Array [
          "84dee23cdc779098a9b1b4db90506e493154570f712c115474e24da8b2a6e965.zip",
        ],
      },
      "Type": "Custom::CDKBucketDeployment",
      "UpdateReplacePolicy": "Delete",
    },
    "OpenSearchPackagesRegisterFunction7CDCEE20": Object {
      "DependsOn": Array [
        "OpenSearchPackagesRegisterFunctionServiceRoleDefaultPolicy3DE31E27",
        "OpenSearchPackagesRegisterFunctionServiceRoleB0065A50",
      ],
      "Properties": Object {
        "Architectures": Array [
          "arm64",
        ],
        "Code": Object {
          "S3Bucket": Object {
            "Fn::Sub": "cdk-hnb659fds-assets-\${AWS::AccountId}-\${AWS::Region}",
          },
          "S3Key": "1c70bd6946704b996b31869ca54823cce9f506b78f42653df8f9c036d807b2fe.zip",
        },
        "Description": "[SocialAnalytics] OpenSearch package register",
        "Environment": Object {
          "Variables": Object {
            "AWS_NODEJS_CONNECTION_REUSE_ENABLED": "1",
          },
        },
        "Handler": "index.handler",
        "Role": Object {
          "Fn::GetAtt": Array [
            "OpenSearchPackagesRegisterFunctionServiceRoleB0065A50",
            "Arn",
          ],
        },
        "Runtime": "nodejs18.x",
        "Timeout": 5,
      },
      "Type": "AWS::Lambda::Function",
    },
    "OpenSearchPackagesRegisterFunctionServiceRoleB0065A50": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "OpenSearchPackagesRegisterFunctionServiceRoleDefaultPolicy3DE31E27": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": Array [
                "es:CreatePackage",
                "es:DescribePackages",
                "es:UpdatePackage",
              ],
              "Effect": "Allow",
              "Resource": "*",
            },
            Object {
              "Action": "s3:GetObject",
              "Effect": "Allow",
              "Resource": Object {
                "Fn::Join": Array [
                  "",
                  Array [
                    Object {
                      "Fn::GetAtt": Array [
                        "Bucket83908E77",
                        "Arn",
                      ],
                    },
                    "/opensearch/packages/*",
                  ],
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "OpenSearchPackagesRegisterFunctionServiceRoleDefaultPolicy3DE31E27",
        "Roles": Array [
          Object {
            "Ref": "OpenSearchPackagesRegisterFunctionServiceRoleB0065A50",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "ReIndexBatchLogs05460884": Object {
      "DeletionPolicy": "Retain",
      "Properties": Object {
        "RetentionInDays": 14,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Retain",
    },
    "ReIndexBatchStateMachineF0BEE136": Object {
      "DependsOn": Array [
        "ReIndexBatchStateMachineRoleDefaultPolicy4E12CA54",
        "ReIndexBatchStateMachineRole9EF1F1C2",
      ],
      "Properties": Object {
        "DefinitionString": Object {
          "Fn::Join": Array [
            "",
            Array [
              "{\\"StartAt\\":\\"Invoke\\",\\"States\\":{\\"Invoke\\":{\\"Type\\":\\"Pass\\",\\"Parameters\\":{\\"Input\\":{\\"created_at_year.$\\":\\"$.year\\"}},\\"Next\\":\\"Query\\"},\\"Query\\":{\\"Next\\":\\"Map\\",\\"Type\\":\\"Task\\",\\"ResultPath\\":\\"$.Result\\",\\"Resource\\":\\"arn:",
              Object {
                "Ref": "AWS::Partition",
              },
              ":states:::aws-sdk:dynamodb:query\\",\\"Parameters\\":{\\"TableName\\":\\"",
              Object {
                "Ref": "TweetTable97F090DB",
              },
              "\\",\\"IndexName\\":\\"created_at-index\\",\\"Limit\\":50,\\"ExpressionAttributeValues\\":{\\":y\\":{\\"S.$\\":\\"$.Input.created_at_year\\"}},\\"KeyConditionExpression\\":\\"created_at_year = :y\\"}},\\"Map\\":{\\"Type\\":\\"Map\\",\\"ResultPath\\":\\"$.Result.Items\\",\\"Next\\":\\"OpenSearchLoad\\",\\"Iterator\\":{\\"StartAt\\":\\"Transform\\",\\"States\\":{\\"Transform\\":{\\"Type\\":\\"Pass\\",\\"Parameters\\":{\\"awsRegion\\":\\"",
              Object {
                "Ref": "AWS::Region",
              },
              "\\",\\"eventID.$\\":\\"$$.Execution.Name\\",\\"eventName\\":\\"MODIFY\\",\\"eventVersion\\":\\"1.1\\",\\"eventSource\\":\\"aws:states\\",\\"eventSourceARN.$\\":\\"$$.StateMachine.Id\\",\\"dynamodb\\":{\\"NewImage.$\\":\\"$\\"}},\\"End\\":true}}},\\"ItemsPath\\":\\"$.Result.Items\\"},\\"Query2\\":{\\"Next\\":\\"Map\\",\\"Type\\":\\"Task\\",\\"ResultPath\\":\\"$.Result\\",\\"Resource\\":\\"arn:",
              Object {
                "Ref": "AWS::Partition",
              },
              ":states:::aws-sdk:dynamodb:query\\",\\"Parameters\\":{\\"TableName\\":\\"",
              Object {
                "Ref": "TweetTable97F090DB",
              },
              "\\",\\"IndexName\\":\\"created_at-index\\",\\"Limit\\":50,\\"ExpressionAttributeValues\\":{\\":y\\":{\\"S.$\\":\\"$.Input.created_at_year\\"}},\\"KeyConditionExpression\\":\\"created_at_year = :y\\",\\"ExclusiveStartKey.$\\":\\"$.Result.LastEvaluatedKey\\"}},\\"LastEvaluatedKey?\\":{\\"Type\\":\\"Choice\\",\\"Choices\\":[{\\"Variable\\":\\"$.Result.LastEvaluatedKey\\",\\"IsPresent\\":true,\\"Next\\":\\"Query2\\"}],\\"Default\\":\\"Succeed\\"},\\"OpenSearchLoad\\":{\\"Next\\":\\"LastEvaluatedKey?\\",\\"Retry\\":[{\\"ErrorEquals\\":[\\"Lambda.ServiceException\\",\\"Lambda.AWSLambdaException\\",\\"Lambda.SdkClientException\\"],\\"IntervalSeconds\\":2,\\"MaxAttempts\\":6,\\"BackoffRate\\":2}],\\"Type\\":\\"Task\\",\\"ResultPath\\":null,\\"Resource\\":\\"arn:",
              Object {
                "Ref": "AWS::Partition",
              },
              ":states:::lambda:invoke\\",\\"Parameters\\":{\\"FunctionName\\":\\"",
              Object {
                "Fn::GetAtt": Array [
                  "OpenSearchLoaderFunction713423B0",
                  "Arn",
                ],
              },
              "\\",\\"Payload\\":{\\"Records.$\\":\\"$.Result.Items\\"}}},\\"Succeed\\":{\\"Type\\":\\"Succeed\\"}}}",
            ],
          ],
        },
        "LoggingConfiguration": Object {
          "Destinations": Array [
            Object {
              "CloudWatchLogsLogGroup": Object {
                "LogGroupArn": Object {
                  "Fn::GetAtt": Array [
                    "ReIndexBatchLogs05460884",
                    "Arn",
                  ],
                },
              },
            },
          ],
          "Level": "ERROR",
        },
        "RoleArn": Object {
          "Fn::GetAtt": Array [
            "ReIndexBatchStateMachineRole9EF1F1C2",
            "Arn",
          ],
        },
      },
      "Type": "AWS::StepFunctions::StateMachine",
    },
    "ReIndexBatchStateMachineRole9EF1F1C2": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": Object {
                  "Fn::FindInMap": Array [
                    "ServiceprincipalMap",
                    Object {
                      "Ref": "AWS::Region",
                    },
                    "states",
                  ],
                },
              },
            },
          ],
          "Version": "2012-10-17",
        },
      },
      "Type": "AWS::IAM::Role",
    },
    "ReIndexBatchStateMachineRoleDefaultPolicy4E12CA54": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": Array [
                "logs:CreateLogDelivery",
                "logs:GetLogDelivery",
                "logs:UpdateLogDelivery",
                "logs:DeleteLogDelivery",
                "logs:ListLogDeliveries",
                "logs:PutResourcePolicy",
                "logs:DescribeResourcePolicies",
                "logs:DescribeLogGroups",
              ],
              "Effect": "Allow",
              "Resource": "*",
            },
            Object {
              "Action": "dynamodb:Query",
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "TweetTable97F090DB",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "TweetTable97F090DB",
                          "Arn",
                        ],
                      },
                      "/index/*",
                    ],
                  ],
                },
              ],
            },
            Object {
              "Action": "lambda:InvokeFunction",
              "Effect": "Allow",
              "Resource": Array [
                Object {
                  "Fn::GetAtt": Array [
                    "OpenSearchLoaderFunction713423B0",
                    "Arn",
                  ],
                },
                Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      Object {
                        "Fn::GetAtt": Array [
                          "OpenSearchLoaderFunction713423B0",
                          "Arn",
                        ],
                      },
                      ":*",
                    ],
                  ],
                },
              ],
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "ReIndexBatchStateMachineRoleDefaultPolicy4E12CA54",
        "Roles": Array [
          Object {
            "Ref": "ReIndexBatchStateMachineRole9EF1F1C2",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "TweetProducerCluster6AB7F416": Object {
      "Properties": Object {
        "ClusterSettings": Array [
          Object {
            "Name": "containerInsights",
            "Value": "enabled",
          },
        ],
      },
      "Type": "AWS::ECS::Cluster",
    },
    "TweetProducerPrimaryQueueD1FD7131": Object {
      "DeletionPolicy": "Delete",
      "Properties": Object {
        "FifoQueue": true,
      },
      "Type": "AWS::SQS::Queue",
      "UpdateReplacePolicy": "Delete",
    },
    "TweetProducerQueueToEventBusFunction63BB4639": Object {
      "DependsOn": Array [
        "TweetProducerQueueToEventBusFunctionServiceRoleDefaultPolicy266E49D4",
        "TweetProducerQueueToEventBusFunctionServiceRoleF0225652",
      ],
      "Properties": Object {
        "Architectures": Array [
          "arm64",
        ],
        "Code": Object {
          "S3Bucket": Object {
            "Fn::Sub": "cdk-hnb659fds-assets-\${AWS::AccountId}-\${AWS::Region}",
          },
          "S3Key": "ceaa3eeb8d7ee26b339337aa1284791f7e5a11be86288e5281bcfbdf41722485.zip",
        },
        "Description": "SocialAnalytics - Process queues from TweetProducer",
        "Environment": Object {
          "Variables": Object {
            "AWS_NODEJS_CONNECTION_REUSE_ENABLED": "1",
            "EVENT_BUS_ARN": Object {
              "Fn::GetAtt": Array [
                "TwitterEventBusC40513FF",
                "Arn",
              ],
            },
          },
        },
        "Handler": "index.handler",
        "Role": Object {
          "Fn::GetAtt": Array [
            "TweetProducerQueueToEventBusFunctionServiceRoleF0225652",
            "Arn",
          ],
        },
        "Runtime": "nodejs18.x",
        "Timeout": 5,
        "TracingConfig": Object {
          "Mode": "Active",
        },
      },
      "Type": "AWS::Lambda::Function",
    },
    "TweetProducerQueueToEventBusFunctionServiceRoleDefaultPolicy266E49D4": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": Array [
                "xray:PutTraceSegments",
                "xray:PutTelemetryRecords",
              ],
              "Effect": "Allow",
              "Resource": "*",
            },
            Object {
              "Action": Array [
                "sqs:ReceiveMessage",
                "sqs:ChangeMessageVisibility",
                "sqs:GetQueueUrl",
                "sqs:DeleteMessage",
                "sqs:GetQueueAttributes",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "TweetProducerPrimaryQueueD1FD7131",
                  "Arn",
                ],
              },
            },
            Object {
              "Action": Array [
                "sqs:ReceiveMessage",
                "sqs:ChangeMessageVisibility",
                "sqs:GetQueueUrl",
                "sqs:DeleteMessage",
                "sqs:GetQueueAttributes",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "TweetProducerSecondaryQueue61E55B34",
                  "Arn",
                ],
              },
            },
            Object {
              "Action": "events:PutEvents",
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "TwitterEventBusC40513FF",
                  "Arn",
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "TweetProducerQueueToEventBusFunctionServiceRoleDefaultPolicy266E49D4",
        "Roles": Array [
          Object {
            "Ref": "TweetProducerQueueToEventBusFunctionServiceRoleF0225652",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "TweetProducerQueueToEventBusFunctionServiceRoleF0225652": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "TweetProducerQueueToEventBusFunctionSqsEventSourcetestTweetProducerPrimaryQueue6BEAEE9031CE7C67": Object {
      "Properties": Object {
        "EventSourceArn": Object {
          "Fn::GetAtt": Array [
            "TweetProducerPrimaryQueueD1FD7131",
            "Arn",
          ],
        },
        "FunctionName": Object {
          "Ref": "TweetProducerQueueToEventBusFunction63BB4639",
        },
      },
      "Type": "AWS::Lambda::EventSourceMapping",
    },
    "TweetProducerQueueToEventBusFunctionSqsEventSourcetestTweetProducerSecondaryQueueBAFE9E7E3222FD4A": Object {
      "Properties": Object {
        "EventSourceArn": Object {
          "Fn::GetAtt": Array [
            "TweetProducerSecondaryQueue61E55B34",
            "Arn",
          ],
        },
        "FunctionName": Object {
          "Ref": "TweetProducerQueueToEventBusFunction63BB4639",
        },
      },
      "Type": "AWS::Lambda::EventSourceMapping",
    },
    "TweetProducerSecondaryQueue61E55B34": Object {
      "DeletionPolicy": "Delete",
      "Type": "AWS::SQS::Queue",
      "UpdateReplacePolicy": "Delete",
    },
    "TweetProducerSecurityGroupCE3DC5EA": Object {
      "Properties": Object {
        "GroupDescription": "test/TweetProducer/SecurityGroup",
        "SecurityGroupEgress": Array [
          Object {
            "CidrIp": "0.0.0.0/0",
            "Description": "Allow all outbound traffic by default",
            "IpProtocol": "-1",
          },
        ],
        "VpcId": Object {
          "Ref": "TweetProducerVPC4D4B8A57",
        },
      },
      "Type": "AWS::EC2::SecurityGroup",
    },
    "TweetProducerStreamReader1BearerTokenParameter72F7D3ED": Object {
      "Properties": Object {
        "Description": "test/TweetProducer/StreamReader1/BearerTokenParameter",
        "Name": Object {
          "Fn::Join": Array [
            "",
            Array [
              "/",
              Object {
                "Ref": "AWS::StackName",
              },
              "/TweetProducer/StreamReader1/BearerToken",
            ],
          ],
        },
        "Type": "String",
        "Value": Object {
          "Ref": "TweetProducerStreamReader1BearerTokenB1FAF3C8",
        },
      },
      "Type": "AWS::SSM::Parameter",
    },
    "TweetProducerStreamReader1Logs67F02D71": Object {
      "DeletionPolicy": "Retain",
      "Properties": Object {
        "RetentionInDays": 14,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Retain",
    },
    "TweetProducerStreamReader1ServiceDAE636A5": Object {
      "Properties": Object {
        "Cluster": Object {
          "Ref": "TweetProducerCluster6AB7F416",
        },
        "DeploymentConfiguration": Object {
          "MaximumPercent": 100,
          "MinimumHealthyPercent": 0,
        },
        "DesiredCount": Object {
          "Fn::If": Array [
            "TweetProducerStreamReader1DisabledF9BFE6E9",
            0,
            1,
          ],
        },
        "EnableECSManagedTags": false,
        "LaunchType": "FARGATE",
        "NetworkConfiguration": Object {
          "AwsvpcConfiguration": Object {
            "AssignPublicIp": "ENABLED",
            "SecurityGroups": Array [
              Object {
                "Fn::GetAtt": Array [
                  "TweetProducerSecurityGroupCE3DC5EA",
                  "GroupId",
                ],
              },
            ],
            "Subnets": Array [
              Object {
                "Ref": "TweetProducerVPCPublicSubnet1Subnet344FBEDB",
              },
              Object {
                "Ref": "TweetProducerVPCPublicSubnet2SubnetD2FD2A8D",
              },
            ],
          },
        },
        "TaskDefinition": Object {
          "Ref": "TweetProducerStreamReader1TaskDefDFDC4B44",
        },
      },
      "Type": "AWS::ECS::Service",
    },
    "TweetProducerStreamReader1TaskDefDFDC4B44": Object {
      "Properties": Object {
        "ContainerDefinitions": Array [
          Object {
            "Cpu": 128,
            "DependsOn": Array [
              Object {
                "Condition": "START",
                "ContainerName": "otel-collector",
              },
            ],
            "Environment": Array [
              Object {
                "Name": "OTEL_SERVICE_NAME",
                "Value": "TweetProducer/StreamReader1",
              },
              Object {
                "Name": "QUEUE_URL_1",
                "Value": Object {
                  "Ref": "TweetProducerPrimaryQueueD1FD7131",
                },
              },
              Object {
                "Name": "QUEUE_URL_2",
                "Value": Object {
                  "Ref": "TweetProducerSecondaryQueue61E55B34",
                },
              },
            ],
            "Essential": true,
            "Image": Object {
              "Fn::Sub": "\${AWS::AccountId}.dkr.ecr.\${AWS::Region}.\${AWS::URLSuffix}/cdk-hnb659fds-container-assets-\${AWS::AccountId}-\${AWS::Region}:3a2d49fe93564642acb734d67e6b5adb94695bcd9f496418535cb6b721c1aac3",
            },
            "LogConfiguration": Object {
              "LogDriver": "awslogs",
              "Options": Object {
                "awslogs-group": Object {
                  "Ref": "TweetProducerStreamReader1Logs67F02D71",
                },
                "awslogs-region": Object {
                  "Ref": "AWS::Region",
                },
                "awslogs-stream-prefix": "ecs",
              },
            },
            "MemoryReservation": 256,
            "Name": "app",
            "ReadonlyRootFilesystem": true,
            "Secrets": Array [
              Object {
                "Name": "TWITTER_BEARER_TOKEN",
                "ValueFrom": Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      "arn:",
                      Object {
                        "Ref": "AWS::Partition",
                      },
                      ":ssm:",
                      Object {
                        "Ref": "AWS::Region",
                      },
                      ":",
                      Object {
                        "Ref": "AWS::AccountId",
                      },
                      ":parameter",
                      Object {
                        "Ref": "TweetProducerStreamReader1BearerTokenParameter72F7D3ED",
                      },
                    ],
                  ],
                },
              },
              Object {
                "Name": "TWITTER_FIELDS_PARAMS",
                "ValueFrom": Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      "arn:",
                      Object {
                        "Ref": "AWS::Partition",
                      },
                      ":ssm:",
                      Object {
                        "Ref": "AWS::Region",
                      },
                      ":",
                      Object {
                        "Ref": "AWS::AccountId",
                      },
                      ":parameter",
                      Object {
                        "Ref": "TwitterFieldsParamsDD9504EE",
                      },
                    ],
                  ],
                },
              },
            ],
          },
          Object {
            "Command": Array [
              "--config=/etc/ecs/ecs-xray.yaml",
            ],
            "Cpu": 64,
            "Essential": true,
            "Image": "public.ecr.aws/aws-observability/aws-otel-collector:latest",
            "LogConfiguration": Object {
              "LogDriver": "awslogs",
              "Options": Object {
                "awslogs-group": Object {
                  "Ref": "TweetProducerStreamReader1Logs67F02D71",
                },
                "awslogs-region": Object {
                  "Ref": "AWS::Region",
                },
                "awslogs-stream-prefix": "ecs",
              },
            },
            "MemoryReservation": 128,
            "Name": "otel-collector",
            "ReadonlyRootFilesystem": true,
          },
        ],
        "Cpu": "256",
        "ExecutionRoleArn": Object {
          "Fn::GetAtt": Array [
            "TweetProducerTaskExecutionRoleD602B472",
            "Arn",
          ],
        },
        "Family": "testTweetProducerStreamReader1TaskDef778F7E6E",
        "Memory": "512",
        "NetworkMode": "awsvpc",
        "RequiresCompatibilities": Array [
          "FARGATE",
        ],
        "RuntimePlatform": Object {
          "CpuArchitecture": "X86_64",
          "OperatingSystemFamily": "LINUX",
        },
        "TaskRoleArn": Object {
          "Fn::GetAtt": Array [
            "TweetProducerTaskRole1DDCA7CB",
            "Arn",
          ],
        },
      },
      "Type": "AWS::ECS::TaskDefinition",
    },
    "TweetProducerStreamReader2BearerTokenParameterC90C5ECA": Object {
      "Properties": Object {
        "Description": "test/TweetProducer/StreamReader2/BearerTokenParameter",
        "Name": Object {
          "Fn::Join": Array [
            "",
            Array [
              "/",
              Object {
                "Ref": "AWS::StackName",
              },
              "/TweetProducer/StreamReader2/BearerToken",
            ],
          ],
        },
        "Type": "String",
        "Value": Object {
          "Ref": "TweetProducerStreamReader2BearerToken679CDF8C",
        },
      },
      "Type": "AWS::SSM::Parameter",
    },
    "TweetProducerStreamReader2Logs5002FC8B": Object {
      "DeletionPolicy": "Retain",
      "Properties": Object {
        "RetentionInDays": 14,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Retain",
    },
    "TweetProducerStreamReader2Service808171C8": Object {
      "Properties": Object {
        "Cluster": Object {
          "Ref": "TweetProducerCluster6AB7F416",
        },
        "DeploymentConfiguration": Object {
          "MaximumPercent": 100,
          "MinimumHealthyPercent": 0,
        },
        "DesiredCount": Object {
          "Fn::If": Array [
            "TweetProducerStreamReader2Disabled63DEA594",
            0,
            1,
          ],
        },
        "EnableECSManagedTags": false,
        "LaunchType": "FARGATE",
        "NetworkConfiguration": Object {
          "AwsvpcConfiguration": Object {
            "AssignPublicIp": "ENABLED",
            "SecurityGroups": Array [
              Object {
                "Fn::GetAtt": Array [
                  "TweetProducerSecurityGroupCE3DC5EA",
                  "GroupId",
                ],
              },
            ],
            "Subnets": Array [
              Object {
                "Ref": "TweetProducerVPCPublicSubnet1Subnet344FBEDB",
              },
              Object {
                "Ref": "TweetProducerVPCPublicSubnet2SubnetD2FD2A8D",
              },
            ],
          },
        },
        "TaskDefinition": Object {
          "Ref": "TweetProducerStreamReader2TaskDef94827F2E",
        },
      },
      "Type": "AWS::ECS::Service",
    },
    "TweetProducerStreamReader2TaskDef94827F2E": Object {
      "Properties": Object {
        "ContainerDefinitions": Array [
          Object {
            "Cpu": 128,
            "DependsOn": Array [
              Object {
                "Condition": "START",
                "ContainerName": "otel-collector",
              },
            ],
            "Environment": Array [
              Object {
                "Name": "OTEL_SERVICE_NAME",
                "Value": "TweetProducer/StreamReader2",
              },
              Object {
                "Name": "QUEUE_URL_1",
                "Value": Object {
                  "Ref": "TweetProducerPrimaryQueueD1FD7131",
                },
              },
              Object {
                "Name": "QUEUE_URL_2",
                "Value": Object {
                  "Ref": "TweetProducerSecondaryQueue61E55B34",
                },
              },
            ],
            "Essential": true,
            "Image": Object {
              "Fn::Sub": "\${AWS::AccountId}.dkr.ecr.\${AWS::Region}.\${AWS::URLSuffix}/cdk-hnb659fds-container-assets-\${AWS::AccountId}-\${AWS::Region}:3a2d49fe93564642acb734d67e6b5adb94695bcd9f496418535cb6b721c1aac3",
            },
            "LogConfiguration": Object {
              "LogDriver": "awslogs",
              "Options": Object {
                "awslogs-group": Object {
                  "Ref": "TweetProducerStreamReader2Logs5002FC8B",
                },
                "awslogs-region": Object {
                  "Ref": "AWS::Region",
                },
                "awslogs-stream-prefix": "ecs",
              },
            },
            "MemoryReservation": 256,
            "Name": "app",
            "ReadonlyRootFilesystem": true,
            "Secrets": Array [
              Object {
                "Name": "TWITTER_BEARER_TOKEN",
                "ValueFrom": Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      "arn:",
                      Object {
                        "Ref": "AWS::Partition",
                      },
                      ":ssm:",
                      Object {
                        "Ref": "AWS::Region",
                      },
                      ":",
                      Object {
                        "Ref": "AWS::AccountId",
                      },
                      ":parameter",
                      Object {
                        "Ref": "TweetProducerStreamReader2BearerTokenParameterC90C5ECA",
                      },
                    ],
                  ],
                },
              },
              Object {
                "Name": "TWITTER_FIELDS_PARAMS",
                "ValueFrom": Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      "arn:",
                      Object {
                        "Ref": "AWS::Partition",
                      },
                      ":ssm:",
                      Object {
                        "Ref": "AWS::Region",
                      },
                      ":",
                      Object {
                        "Ref": "AWS::AccountId",
                      },
                      ":parameter",
                      Object {
                        "Ref": "TwitterFieldsParamsDD9504EE",
                      },
                    ],
                  ],
                },
              },
            ],
          },
          Object {
            "Command": Array [
              "--config=/etc/ecs/ecs-xray.yaml",
            ],
            "Cpu": 64,
            "Essential": true,
            "Image": "public.ecr.aws/aws-observability/aws-otel-collector:latest",
            "LogConfiguration": Object {
              "LogDriver": "awslogs",
              "Options": Object {
                "awslogs-group": Object {
                  "Ref": "TweetProducerStreamReader2Logs5002FC8B",
                },
                "awslogs-region": Object {
                  "Ref": "AWS::Region",
                },
                "awslogs-stream-prefix": "ecs",
              },
            },
            "MemoryReservation": 128,
            "Name": "otel-collector",
            "ReadonlyRootFilesystem": true,
          },
        ],
        "Cpu": "256",
        "ExecutionRoleArn": Object {
          "Fn::GetAtt": Array [
            "TweetProducerTaskExecutionRoleD602B472",
            "Arn",
          ],
        },
        "Family": "testTweetProducerStreamReader2TaskDef9DFC444F",
        "Memory": "512",
        "NetworkMode": "awsvpc",
        "RequiresCompatibilities": Array [
          "FARGATE",
        ],
        "RuntimePlatform": Object {
          "CpuArchitecture": "X86_64",
          "OperatingSystemFamily": "LINUX",
        },
        "TaskRoleArn": Object {
          "Fn::GetAtt": Array [
            "TweetProducerTaskRole1DDCA7CB",
            "Arn",
          ],
        },
      },
      "Type": "AWS::ECS::TaskDefinition",
    },
    "TweetProducerStreamReader3BearerTokenParameterF2ACA288": Object {
      "Properties": Object {
        "Description": "test/TweetProducer/StreamReader3/BearerTokenParameter",
        "Name": Object {
          "Fn::Join": Array [
            "",
            Array [
              "/",
              Object {
                "Ref": "AWS::StackName",
              },
              "/TweetProducer/StreamReader3/BearerToken",
            ],
          ],
        },
        "Type": "String",
        "Value": Object {
          "Ref": "TweetProducerStreamReader3BearerToken372B9251",
        },
      },
      "Type": "AWS::SSM::Parameter",
    },
    "TweetProducerStreamReader3LogsA8D004C1": Object {
      "DeletionPolicy": "Retain",
      "Properties": Object {
        "RetentionInDays": 14,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Retain",
    },
    "TweetProducerStreamReader3Service6DF18CD5": Object {
      "Properties": Object {
        "Cluster": Object {
          "Ref": "TweetProducerCluster6AB7F416",
        },
        "DeploymentConfiguration": Object {
          "MaximumPercent": 100,
          "MinimumHealthyPercent": 0,
        },
        "DesiredCount": Object {
          "Fn::If": Array [
            "TweetProducerStreamReader3Disabled4F1E6EA5",
            0,
            1,
          ],
        },
        "EnableECSManagedTags": false,
        "LaunchType": "FARGATE",
        "NetworkConfiguration": Object {
          "AwsvpcConfiguration": Object {
            "AssignPublicIp": "ENABLED",
            "SecurityGroups": Array [
              Object {
                "Fn::GetAtt": Array [
                  "TweetProducerSecurityGroupCE3DC5EA",
                  "GroupId",
                ],
              },
            ],
            "Subnets": Array [
              Object {
                "Ref": "TweetProducerVPCPublicSubnet1Subnet344FBEDB",
              },
              Object {
                "Ref": "TweetProducerVPCPublicSubnet2SubnetD2FD2A8D",
              },
            ],
          },
        },
        "TaskDefinition": Object {
          "Ref": "TweetProducerStreamReader3TaskDefC6A8F8B8",
        },
      },
      "Type": "AWS::ECS::Service",
    },
    "TweetProducerStreamReader3TaskDefC6A8F8B8": Object {
      "Properties": Object {
        "ContainerDefinitions": Array [
          Object {
            "Cpu": 128,
            "DependsOn": Array [
              Object {
                "Condition": "START",
                "ContainerName": "otel-collector",
              },
            ],
            "Environment": Array [
              Object {
                "Name": "OTEL_SERVICE_NAME",
                "Value": "TweetProducer/StreamReader3",
              },
              Object {
                "Name": "QUEUE_URL_1",
                "Value": Object {
                  "Ref": "TweetProducerPrimaryQueueD1FD7131",
                },
              },
              Object {
                "Name": "QUEUE_URL_2",
                "Value": Object {
                  "Ref": "TweetProducerSecondaryQueue61E55B34",
                },
              },
            ],
            "Essential": true,
            "Image": Object {
              "Fn::Sub": "\${AWS::AccountId}.dkr.ecr.\${AWS::Region}.\${AWS::URLSuffix}/cdk-hnb659fds-container-assets-\${AWS::AccountId}-\${AWS::Region}:3a2d49fe93564642acb734d67e6b5adb94695bcd9f496418535cb6b721c1aac3",
            },
            "LogConfiguration": Object {
              "LogDriver": "awslogs",
              "Options": Object {
                "awslogs-group": Object {
                  "Ref": "TweetProducerStreamReader3LogsA8D004C1",
                },
                "awslogs-region": Object {
                  "Ref": "AWS::Region",
                },
                "awslogs-stream-prefix": "ecs",
              },
            },
            "MemoryReservation": 256,
            "Name": "app",
            "ReadonlyRootFilesystem": true,
            "Secrets": Array [
              Object {
                "Name": "TWITTER_BEARER_TOKEN",
                "ValueFrom": Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      "arn:",
                      Object {
                        "Ref": "AWS::Partition",
                      },
                      ":ssm:",
                      Object {
                        "Ref": "AWS::Region",
                      },
                      ":",
                      Object {
                        "Ref": "AWS::AccountId",
                      },
                      ":parameter",
                      Object {
                        "Ref": "TweetProducerStreamReader3BearerTokenParameterF2ACA288",
                      },
                    ],
                  ],
                },
              },
              Object {
                "Name": "TWITTER_FIELDS_PARAMS",
                "ValueFrom": Object {
                  "Fn::Join": Array [
                    "",
                    Array [
                      "arn:",
                      Object {
                        "Ref": "AWS::Partition",
                      },
                      ":ssm:",
                      Object {
                        "Ref": "AWS::Region",
                      },
                      ":",
                      Object {
                        "Ref": "AWS::AccountId",
                      },
                      ":parameter",
                      Object {
                        "Ref": "TwitterFieldsParamsDD9504EE",
                      },
                    ],
                  ],
                },
              },
            ],
          },
          Object {
            "Command": Array [
              "--config=/etc/ecs/ecs-xray.yaml",
            ],
            "Cpu": 64,
            "Essential": true,
            "Image": "public.ecr.aws/aws-observability/aws-otel-collector:latest",
            "LogConfiguration": Object {
              "LogDriver": "awslogs",
              "Options": Object {
                "awslogs-group": Object {
                  "Ref": "TweetProducerStreamReader3LogsA8D004C1",
                },
                "awslogs-region": Object {
                  "Ref": "AWS::Region",
                },
                "awslogs-stream-prefix": "ecs",
              },
            },
            "MemoryReservation": 128,
            "Name": "otel-collector",
            "ReadonlyRootFilesystem": true,
          },
        ],
        "Cpu": "256",
        "ExecutionRoleArn": Object {
          "Fn::GetAtt": Array [
            "TweetProducerTaskExecutionRoleD602B472",
            "Arn",
          ],
        },
        "Family": "testTweetProducerStreamReader3TaskDefFF68E053",
        "Memory": "512",
        "NetworkMode": "awsvpc",
        "RequiresCompatibilities": Array [
          "FARGATE",
        ],
        "RuntimePlatform": Object {
          "CpuArchitecture": "X86_64",
          "OperatingSystemFamily": "LINUX",
        },
        "TaskRoleArn": Object {
          "Fn::GetAtt": Array [
            "TweetProducerTaskRole1DDCA7CB",
            "Arn",
          ],
        },
      },
      "Type": "AWS::ECS::TaskDefinition",
    },
    "TweetProducerTaskExecutionRoleD602B472": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "ecs-tasks.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "TweetProducerTaskExecutionRoleDefaultPolicyD0F99842": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": Array [
                "ecr:BatchCheckLayerAvailability",
                "ecr:GetDownloadUrlForLayer",
                "ecr:BatchGetImage",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::Join": Array [
                  "",
                  Array [
                    "arn:",
                    Object {
                      "Ref": "AWS::Partition",
                    },
                    ":ecr:",
                    Object {
                      "Ref": "AWS::Region",
                    },
                    ":",
                    Object {
                      "Ref": "AWS::AccountId",
                    },
                    ":repository/",
                    Object {
                      "Fn::Sub": "cdk-hnb659fds-container-assets-\${AWS::AccountId}-\${AWS::Region}",
                    },
                  ],
                ],
              },
            },
            Object {
              "Action": "ecr:GetAuthorizationToken",
              "Effect": "Allow",
              "Resource": "*",
            },
            Object {
              "Action": Array [
                "logs:CreateLogStream",
                "logs:PutLogEvents",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "TweetProducerStreamReader1Logs67F02D71",
                  "Arn",
                ],
              },
            },
            Object {
              "Action": Array [
                "ssm:DescribeParameters",
                "ssm:GetParameters",
                "ssm:GetParameter",
                "ssm:GetParameterHistory",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::Join": Array [
                  "",
                  Array [
                    "arn:",
                    Object {
                      "Ref": "AWS::Partition",
                    },
                    ":ssm:",
                    Object {
                      "Ref": "AWS::Region",
                    },
                    ":",
                    Object {
                      "Ref": "AWS::AccountId",
                    },
                    ":parameter",
                    Object {
                      "Ref": "TweetProducerStreamReader1BearerTokenParameter72F7D3ED",
                    },
                  ],
                ],
              },
            },
            Object {
              "Action": Array [
                "ssm:DescribeParameters",
                "ssm:GetParameters",
                "ssm:GetParameter",
                "ssm:GetParameterHistory",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::Join": Array [
                  "",
                  Array [
                    "arn:",
                    Object {
                      "Ref": "AWS::Partition",
                    },
                    ":ssm:",
                    Object {
                      "Ref": "AWS::Region",
                    },
                    ":",
                    Object {
                      "Ref": "AWS::AccountId",
                    },
                    ":parameter",
                    Object {
                      "Ref": "TwitterFieldsParamsDD9504EE",
                    },
                  ],
                ],
              },
            },
            Object {
              "Action": Array [
                "logs:CreateLogStream",
                "logs:PutLogEvents",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "TweetProducerStreamReader2Logs5002FC8B",
                  "Arn",
                ],
              },
            },
            Object {
              "Action": Array [
                "ssm:DescribeParameters",
                "ssm:GetParameters",
                "ssm:GetParameter",
                "ssm:GetParameterHistory",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::Join": Array [
                  "",
                  Array [
                    "arn:",
                    Object {
                      "Ref": "AWS::Partition",
                    },
                    ":ssm:",
                    Object {
                      "Ref": "AWS::Region",
                    },
                    ":",
                    Object {
                      "Ref": "AWS::AccountId",
                    },
                    ":parameter",
                    Object {
                      "Ref": "TweetProducerStreamReader2BearerTokenParameterC90C5ECA",
                    },
                  ],
                ],
              },
            },
            Object {
              "Action": Array [
                "logs:CreateLogStream",
                "logs:PutLogEvents",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "TweetProducerStreamReader3LogsA8D004C1",
                  "Arn",
                ],
              },
            },
            Object {
              "Action": Array [
                "ssm:DescribeParameters",
                "ssm:GetParameters",
                "ssm:GetParameter",
                "ssm:GetParameterHistory",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::Join": Array [
                  "",
                  Array [
                    "arn:",
                    Object {
                      "Ref": "AWS::Partition",
                    },
                    ":ssm:",
                    Object {
                      "Ref": "AWS::Region",
                    },
                    ":",
                    Object {
                      "Ref": "AWS::AccountId",
                    },
                    ":parameter",
                    Object {
                      "Ref": "TweetProducerStreamReader3BearerTokenParameterF2ACA288",
                    },
                  ],
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "TweetProducerTaskExecutionRoleDefaultPolicyD0F99842",
        "Roles": Array [
          Object {
            "Ref": "TweetProducerTaskExecutionRoleD602B472",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "TweetProducerTaskRole1DDCA7CB": Object {
      "Properties": Object {
        "AssumeRolePolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": Object {
                "Service": "ecs-tasks.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": Array [
          Object {
            "Fn::Join": Array [
              "",
              Array [
                "arn:",
                Object {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/AWSXRayDaemonWriteAccess",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "TweetProducerTaskRoleDefaultPolicy43F85DDB": Object {
      "Properties": Object {
        "PolicyDocument": Object {
          "Statement": Array [
            Object {
              "Action": Array [
                "sqs:SendMessage",
                "sqs:GetQueueAttributes",
                "sqs:GetQueueUrl",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "TweetProducerPrimaryQueueD1FD7131",
                  "Arn",
                ],
              },
            },
            Object {
              "Action": Array [
                "sqs:SendMessage",
                "sqs:GetQueueAttributes",
                "sqs:GetQueueUrl",
              ],
              "Effect": "Allow",
              "Resource": Object {
                "Fn::GetAtt": Array [
                  "TweetProducerSecondaryQueue61E55B34",
                  "Arn",
                ],
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "TweetProducerTaskRoleDefaultPolicy43F85DDB",
        "Roles": Array [
          Object {
            "Ref": "TweetProducerTaskRole1DDCA7CB",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "TweetProducerVPC4D4B8A57": Object {
      "Properties": Object {
        "CidrBlock": "10.0.0.0/16",
        "EnableDnsHostnames": true,
        "EnableDnsSupport": true,
        "InstanceTenancy": "default",
        "Tags": Array [
          Object {
            "Key": "Name",
            "Value": "test/TweetProducer/VPC",
          },
        ],
      },
      "Type": "AWS::EC2::VPC",
    },
    "TweetProducerVPCIGW96C63A02": Object {
      "Properties": Object {
        "Tags": Array [
          Object {
            "Key": "Name",
            "Value": "test/TweetProducer/VPC",
          },
        ],
      },
      "Type": "AWS::EC2::InternetGateway",
    },
    "TweetProducerVPCPublicSubnet1DefaultRoute7497D0E4": Object {
      "DependsOn": Array [
        "TweetProducerVPCVPCGW3C72F75D",
      ],
      "Properties": Object {
        "DestinationCidrBlock": "0.0.0.0/0",
        "GatewayId": Object {
          "Ref": "TweetProducerVPCIGW96C63A02",
        },
        "RouteTableId": Object {
          "Ref": "TweetProducerVPCPublicSubnet1RouteTableDE26BEFB",
        },
      },
      "Type": "AWS::EC2::Route",
    },
    "TweetProducerVPCPublicSubnet1RouteTableAssociation4E58D7CF": Object {
      "Properties": Object {
        "RouteTableId": Object {
          "Ref": "TweetProducerVPCPublicSubnet1RouteTableDE26BEFB",
        },
        "SubnetId": Object {
          "Ref": "TweetProducerVPCPublicSubnet1Subnet344FBEDB",
        },
      },
      "Type": "AWS::EC2::SubnetRouteTableAssociation",
    },
    "TweetProducerVPCPublicSubnet1RouteTableDE26BEFB": Object {
      "Properties": Object {
        "Tags": Array [
          Object {
            "Key": "Name",
            "Value": "test/TweetProducer/VPC/PublicSubnet1",
          },
        ],
        "VpcId": Object {
          "Ref": "TweetProducerVPC4D4B8A57",
        },
      },
      "Type": "AWS::EC2::RouteTable",
    },
    "TweetProducerVPCPublicSubnet1Subnet344FBEDB": Object {
      "Properties": Object {
        "AvailabilityZone": Object {
          "Fn::Select": Array [
            0,
            Object {
              "Fn::GetAZs": "",
            },
          ],
        },
        "CidrBlock": "10.0.0.0/24",
        "MapPublicIpOnLaunch": true,
        "Tags": Array [
          Object {
            "Key": "aws-cdk:subnet-name",
            "Value": "Public",
          },
          Object {
            "Key": "aws-cdk:subnet-type",
            "Value": "Public",
          },
          Object {
            "Key": "Name",
            "Value": "test/TweetProducer/VPC/PublicSubnet1",
          },
        ],
        "VpcId": Object {
          "Ref": "TweetProducerVPC4D4B8A57",
        },
      },
      "Type": "AWS::EC2::Subnet",
    },
    "TweetProducerVPCPublicSubnet2DefaultRoute8EA79C50": Object {
      "DependsOn": Array [
        "TweetProducerVPCVPCGW3C72F75D",
      ],
      "Properties": Object {
        "DestinationCidrBlock": "0.0.0.0/0",
        "GatewayId": Object {
          "Ref": "TweetProducerVPCIGW96C63A02",
        },
        "RouteTableId": Object {
          "Ref": "TweetProducerVPCPublicSubnet2RouteTableD5C3AC57",
        },
      },
      "Type": "AWS::EC2::Route",
    },
    "TweetProducerVPCPublicSubnet2RouteTableAssociationC0E82576": Object {
      "Properties": Object {
        "RouteTableId": Object {
          "Ref": "TweetProducerVPCPublicSubnet2RouteTableD5C3AC57",
        },
        "SubnetId": Object {
          "Ref": "TweetProducerVPCPublicSubnet2SubnetD2FD2A8D",
        },
      },
      "Type": "AWS::EC2::SubnetRouteTableAssociation",
    },
    "TweetProducerVPCPublicSubnet2RouteTableD5C3AC57": Object {
      "Properties": Object {
        "Tags": Array [
          Object {
            "Key": "Name",
            "Value": "test/TweetProducer/VPC/PublicSubnet2",
          },
        ],
        "VpcId": Object {
          "Ref": "TweetProducerVPC4D4B8A57",
        },
      },
      "Type": "AWS::EC2::RouteTable",
    },
    "TweetProducerVPCPublicSubnet2SubnetD2FD2A8D": Object {
      "Properties": Object {
        "AvailabilityZone": Object {
          "Fn::Select": Array [
            1,
            Object {
              "Fn::GetAZs": "",
            },
          ],
        },
        "CidrBlock": "10.0.1.0/24",
        "MapPublicIpOnLaunch": true,
        "Tags": Array [
          Object {
            "Key": "aws-cdk:subnet-name",
            "Value": "Public",
          },
          Object {
            "Key": "aws-cdk:subnet-type",
            "Value": "Public",
          },
          Object {
            "Key": "Name",
            "Value": "test/TweetProducer/VPC/PublicSubnet2",
          },
        ],
        "VpcId": Object {
          "Ref": "TweetProducerVPC4D4B8A57",
        },
      },
      "Type": "AWS::EC2::Subnet",
    },
    "TweetProducerVPCVPCGW3C72F75D": Object {
      "Properties": Object {
        "InternetGatewayId": Object {
          "Ref": "TweetProducerVPCIGW96C63A02",
        },
        "VpcId": Object {
          "Ref": "TweetProducerVPC4D4B8A57",
        },
      },
      "Type": "AWS::EC2::VPCGatewayAttachment",
    },
    "TweetTable97F090DB": Object {
      "DeletionPolicy": "Retain",
      "Properties": Object {
        "AttributeDefinitions": Array [
          Object {
            "AttributeName": "id",
            "AttributeType": "S",
          },
          Object {
            "AttributeName": "created_at_year",
            "AttributeType": "S",
          },
          Object {
            "AttributeName": "created_at",
            "AttributeType": "S",
          },
        ],
        "BillingMode": "PAY_PER_REQUEST",
        "GlobalSecondaryIndexes": Array [
          Object {
            "IndexName": "created_at-index",
            "KeySchema": Array [
              Object {
                "AttributeName": "created_at_year",
                "KeyType": "HASH",
              },
              Object {
                "AttributeName": "created_at",
                "KeyType": "RANGE",
              },
            ],
            "Projection": Object {
              "ProjectionType": "KEYS_ONLY",
            },
          },
        ],
        "KeySchema": Array [
          Object {
            "AttributeName": "id",
            "KeyType": "HASH",
          },
        ],
        "StreamSpecification": Object {
          "StreamViewType": "NEW_IMAGE",
        },
      },
      "Type": "AWS::DynamoDB::Table",
      "UpdateReplacePolicy": "Retain",
    },
    "TwitterEventBusArchive3E28C9EF": Object {
      "Properties": Object {
        "Description": Object {
          "Fn::Join": Array [
            "",
            Array [
              "Event Archive for ",
              Object {
                "Ref": "TwitterEventBusC40513FF",
              },
              " Event Bus",
            ],
          ],
        },
        "EventPattern": Object {
          "detail": Object {
            "data": Object {
              "source": Array [
                Object {
                  "anything-but": Object {
                    "Fn::Split": Array [
                      ",",
                      Object {
                        "Fn::GetAtt": Array [
                          "twitterFilterSourceLabelsEC9A582C",
                          "Value",
                        ],
                      },
                    ],
                  },
                },
              ],
            },
          },
          "source": Array [
            "twitter.api.v2",
          ],
        },
        "RetentionDays": 0,
        "SourceArn": Object {
          "Fn::GetAtt": Array [
            "TwitterEventBusC40513FF",
            "Arn",
          ],
        },
      },
      "Type": "AWS::Events::Archive",
    },
    "TwitterEventBusC40513FF": Object {
      "Properties": Object {
        "Name": "testTwitterEventBusDF323AE5",
      },
      "Type": "AWS::Events::EventBus",
    },
    "TwitterFieldsParamsDD9504EE": Object {
      "Properties": Object {
        "Description": "Tweet fields params for API calls",
        "Name": Object {
          "Fn::Join": Array [
            "",
            Array [
              "/",
              Object {
                "Ref": "AWS::StackName",
              },
              "/Twitter/FieldsParams",
            ],
          ],
        },
        "Type": "String",
        "Value": "{\\"tweet.fields\\":[\\"id\\",\\"text\\",\\"author_id\\",\\"context_annotations\\",\\"conversation_id\\",\\"created_at\\",\\"entities\\",\\"geo\\",\\"in_reply_to_user_id\\",\\"lang\\",\\"possibly_sensitive\\",\\"public_metrics\\",\\"referenced_tweets\\",\\"reply_settings\\",\\"source\\"],\\"user.fields\\":[\\"id\\",\\"name\\",\\"username\\",\\"url\\",\\"verified\\",\\"public_metrics\\"],\\"place.fields\\":[\\"id\\",\\"full_name\\",\\"contained_within\\",\\"country\\",\\"country_code\\",\\"geo\\",\\"name\\",\\"place_type\\"],\\"expansions\\":[\\"author_id\\",\\"entities.mentions.username\\",\\"in_reply_to_user_id\\",\\"referenced_tweets.id\\",\\"referenced_tweets.id.author_id\\"]}",
      },
      "Type": "AWS::SSM::Parameter",
    },
    "twitterFilterContextDomainsAC1EB275": Object {
      "Properties": Object {
        "Description": "Context domains for filtering",
        "Name": Object {
          "Fn::Join": Array [
            "",
            Array [
              "/",
              Object {
                "Ref": "AWS::StackName",
              },
              "/Twitter/Filter/ContextDomains",
            ],
          ],
        },
        "Type": "StringList",
        "Value": "Musician,Music Genre,Actor,TV Shows,Multimedia Franchise,Fictional Character,Entertainment Personality",
      },
      "Type": "AWS::SSM::Parameter",
    },
    "twitterFilterSourceLabelsEC9A582C": Object {
      "Properties": Object {
        "Description": "Tweet source labels for filtering",
        "Name": Object {
          "Fn::Join": Array [
            "",
            Array [
              "/",
              Object {
                "Ref": "AWS::StackName",
              },
              "/Twitter/Filter/SourceLabels",
            ],
          ],
        },
        "Type": "StringList",
        "Value": "Twitter for Advertisers,twittbot.net,Mk00JapanBot,Gakeppu Tweet,BelugaCampaignSEA,rare_zaiko,Wn32ShimaneBot,uhiiman_bot,atulsbots",
      },
      "Type": "AWS::SSM::Parameter",
    },
  },
  "Rules": Object {
    "CheckBootstrapVersion": Object {
      "Assertions": Array [
        Object {
          "Assert": Object {
            "Fn::Not": Array [
              Object {
                "Fn::Contains": Array [
                  Array [
                    "1",
                    "2",
                    "3",
                    "4",
                    "5",
                  ],
                  Object {
                    "Ref": "BootstrapVersion",
                  },
                ],
              },
            ],
          },
          "AssertDescription": "CDK bootstrap stack version 6 required. Please run 'cdk bootstrap' with a recent version of the CDK CLI.",
        },
      ],
    },
  },
}
`;
